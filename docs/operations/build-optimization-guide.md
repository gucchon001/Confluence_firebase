# ğŸš€ ãƒ“ãƒ«ãƒ‰æœ€é©åŒ–ã‚¬ã‚¤ãƒ‰

**æœ€çµ‚æ›´æ–°:** 2025-10-13

## ğŸ“‹ æ¦‚è¦

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Next.jsãƒ“ãƒ«ãƒ‰æ™‚é–“ã‚’æœ€é©åŒ–ã™ã‚‹ãŸã‚ã®æ¡ä»¶ä»˜ããƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

### å®Ÿè£…ã®èƒŒæ™¯

å¾“æ¥ã®ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€æ¯å›ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã—ãŸï¼š

- **LanceDBãƒ‡ãƒ¼ã‚¿**: 3,518ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰
- **ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜JSON**: ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹
- **Lunrã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: å…¨æ–‡æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ“ãƒ«ãƒ‰æ™‚é–“ãŒ **3-6åˆ†** ã‹ã‹ã£ã¦ã„ã¾ã—ãŸã€‚

### æœ€é©åŒ–å¾Œã®æ”¹å–„

æ¡ä»¶ä»˜ããƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã«ã‚ˆã‚Šï¼š

| é …ç›® | æœ€é©åŒ–å‰ | æœ€é©åŒ–å¾Œ | æ”¹å–„ç‡ |
|------|----------|----------|--------|
| ãƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰ | 3-6åˆ† | 46ç§’ | **75-90%çŸ­ç¸®** |
| Firebase App Hosting ãƒ‡ãƒ—ãƒ­ã‚¤ | 7-15åˆ† | 2-3åˆ† | **70-80%çŸ­ç¸®** |
| ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ | æ¯å›å®Ÿè¡Œ | ã‚¹ã‚­ãƒƒãƒ—å¯èƒ½ | æŸ”è»Ÿã«é¸æŠå¯èƒ½ |

## ğŸ› ï¸ ãƒ“ãƒ«ãƒ‰ãƒ¢ãƒ¼ãƒ‰

### 1. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ“ãƒ«ãƒ‰ï¼ˆæ¨å¥¨ï¼‰

```bash
npm run build
```

**å‹•ä½œ:**
- ãƒ­ãƒ¼ã‚«ãƒ«ã« `.lancedb` ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå­˜åœ¨ã™ã‚‹å ´åˆ: ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒƒãƒ—
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå­˜åœ¨ã—ãªã„å ´åˆ: ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

**ç”¨é€”:** é€šå¸¸ã®é–‹ç™ºãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤

### 2. é«˜é€Ÿãƒ“ãƒ«ãƒ‰

```bash
npm run build:fast
```

**å‹•ä½œ:**
- ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’å¼·åˆ¶çš„ã«ã‚¹ã‚­ãƒƒãƒ—
- ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¾ãŸã¯å®Ÿè¡Œæ™‚ãƒ­ãƒ¼ãƒ‰ã«ä¾å­˜

**ç”¨é€”:**
- é »ç¹ãªãƒ“ãƒ«ãƒ‰ãŒå¿…è¦ãªé–‹ç™ºæ™‚
- CIãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ã®é«˜é€ŸåŒ–
- ãƒ‡ãƒ¼ã‚¿æ›´æ–°ãŒä¸è¦ãªå ´åˆ

### 3. ãƒ•ãƒ«ãƒ“ãƒ«ãƒ‰

```bash
npm run build:full
```

**å‹•ä½œ:**
- ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’å¼·åˆ¶çš„ã«å®Ÿè¡Œ
- å¸¸ã«æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

**ç”¨é€”:**
- åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚
- ãƒ‡ãƒ¼ã‚¿æ›´æ–°å¾Œã®ç¢ºèª
- ã‚¯ãƒªãƒ¼ãƒ³ãƒ“ãƒ«ãƒ‰ãŒå¿…è¦ãªå ´åˆ

## ğŸ”§ æŠ€è¡“è©³ç´°

### ç’°å¢ƒå¤‰æ•°

**SKIP_DATA_DOWNLOAD**

| å€¤ | å‹•ä½œ |
|----|------|
| `true` | ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒƒãƒ— |
| `false` | ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ |
| æœªè¨­å®š | ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å­˜åœ¨ã§åˆ¤æ–­ |

### å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«

```
scripts/
â”œâ”€â”€ conditional-download.js      # æ¡ä»¶ä»˜ããƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ build-fast.js               # é«˜é€Ÿãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ build-full.js               # ãƒ•ãƒ«ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ download-production-data.ts # ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å®Ÿè£…
```

### ãƒ‡ãƒ¼ã‚¿ã®å®Ÿè¡Œæ™‚ãƒ­ãƒ¼ãƒ‰

ãƒ“ãƒ«ãƒ‰æ™‚ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸå ´åˆã€ãƒ‡ãƒ¼ã‚¿ã¯ä»¥ä¸‹ã®æ–¹æ³•ã§å®Ÿè¡Œæ™‚ã«åˆ©ç”¨å¯èƒ½ï¼š

1. **ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: `.lancedb/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
2. **Cloud Storage**: Firebase App Hostingã‹ã‚‰ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
3. **å®šæœŸåŒæœŸ**: [data-synchronization-strategy.md](./data-synchronization-strategy.md) å‚ç…§

## ğŸš€ Firebase App Hostingè¨­å®š

### apphosting.yaml

```yaml
env:
  # ãƒ“ãƒ«ãƒ‰æœ€é©åŒ–: ãƒ‡ãƒ¼ã‚¿ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ã‚¹ã‚­ãƒƒãƒ—
  - variable: SKIP_DATA_DOWNLOAD
    value: "true"
    availability:
      - BUILD
```

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ãƒ­ãƒ¼

```mermaid
graph LR
    A[Git Push] --> B[Firebaseæ¤œå‡º]
    B --> C[ã‚³ãƒ³ãƒ†ãƒŠãƒ“ãƒ«ãƒ‰]
    C --> D{SKIP_DATA_DOWNLOAD?}
    D -->|true| E[ãƒ‡ãƒ¼ã‚¿DLã‚¹ã‚­ãƒƒãƒ—]
    D -->|false| F[ãƒ‡ãƒ¼ã‚¿DLå®Ÿè¡Œ]
    E --> G[Next.jsãƒ“ãƒ«ãƒ‰ 46ç§’]
    F --> G
    G --> H[ãƒ‡ãƒ—ãƒ­ã‚¤]
```

**çµæœ:**
- ãƒ“ãƒ«ãƒ‰ãƒ•ã‚§ãƒ¼ã‚º: 1-2åˆ†ï¼ˆå¾“æ¥: 5-8åˆ†ï¼‰
- åˆè¨ˆãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“: 2-3åˆ†ï¼ˆå¾“æ¥: 7-15åˆ†ï¼‰

## ğŸ’¡ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### é–‹ç™ºæ™‚

```bash
# åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
npm run build:full

# ä»¥é™ã®é–‹ç™º
npm run build:fast

# ãƒ‡ãƒ¼ã‚¿æ›´æ–°å¾Œ
npm run build:full
```

### CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```yaml
# GitHub Actions ã®ä¾‹
- name: Build (fast mode)
  run: npm run build:fast
  env:
    SKIP_DATA_DOWNLOAD: true
```

### ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚°

ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã¯ã€ãƒ“ãƒ«ãƒ‰æ™‚ã§ã¯ãªãä»¥ä¸‹ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§è¡Œã†ã“ã¨ã‚’æ¨å¥¨ï¼š

1. **å®šæœŸåŒæœŸ**: Firebase Cloud Schedulerã«ã‚ˆã‚‹è‡ªå‹•åŒæœŸ
2. **æ‰‹å‹•åŒæœŸ**: `npm run sync:confluence` ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
3. **å®Ÿè¡Œæ™‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã®è‡ªå‹•æ›´æ–°

è©³ç´°: [data-synchronization-strategy.md](./data-synchronization-strategy.md)

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶:**
```
Error: LanceDB table 'confluence' not found
```

**è§£æ±ºç­–:**
```bash
# ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
npm run build:full

# ã¾ãŸã¯æ‰‹å‹•ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
npx tsx scripts/download-production-data.ts
```

### ãƒ“ãƒ«ãƒ‰æ™‚é–“ãŒæ”¹å–„ã•ã‚Œãªã„

**ç¢ºèªäº‹é …:**
1. `SKIP_DATA_DOWNLOAD` ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹
2. `.lancedb/` ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå­˜åœ¨ã™ã‚‹ã‹
3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€Ÿåº¦ï¼ˆCloud Storageã‚¢ã‚¯ã‚»ã‚¹ï¼‰

**ãƒ‡ãƒãƒƒã‚°:**
```bash
# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
SKIP_DATA_DOWNLOAD=true npm run build 2>&1 | tee build.log
```

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®ã‚¯ãƒªã‚¢

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤
rm -rf .lancedb/
rm -rf data/domain-knowledge-v2/
rm -rf .cache/

# å†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
npm run build:full
```

## ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### ãƒ“ãƒ«ãƒ‰æ™‚é–“ã®å†…è¨³

**æœ€é©åŒ–å‰:**
```
ãƒ—ãƒªãƒ“ãƒ«ãƒ‰ï¼ˆãƒ‡ãƒ¼ã‚¿DLï¼‰: 120-300ç§’ (67%)
Next.jsã‚³ãƒ³ãƒ‘ã‚¤ãƒ«:       58ç§’      (33%)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
åˆè¨ˆ:                    178-358ç§’
```

**æœ€é©åŒ–å¾Œ:**
```
ãƒ—ãƒªãƒ“ãƒ«ãƒ‰ï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰:   0ç§’       (0%)
Next.jsã‚³ãƒ³ãƒ‘ã‚¤ãƒ«:       46ç§’      (100%)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
åˆè¨ˆ:                    46ç§’
```

### ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡

| ãƒ‡ãƒ¼ã‚¿ | ã‚µã‚¤ã‚º | èª¬æ˜ |
|--------|--------|------|
| `.lancedb/confluence.lance` | ~500MB | ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ |
| `data/domain-knowledge-v2/` | ~10MB | ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜ |
| `.cache/lunr-index.json` | ~5MB | å…¨æ–‡æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ |
| **åˆè¨ˆ** | **~515MB** | ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆè¨ˆ |

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [deployment-guide.md](./deployment-guide.md) - ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰
- [data-synchronization-strategy.md](./data-synchronization-strategy.md) - ãƒ‡ãƒ¼ã‚¿åŒæœŸæˆ¦ç•¥
- [firebase-app-hosting-configuration.md](./firebase-app-hosting-configuration.md) - App Hostingè¨­å®š

## ğŸ“ å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | å¤‰æ›´å†…å®¹ |
|------|----------|
| 2025-10-13 | æ¡ä»¶ä»˜ããƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’å®Ÿè£…ã€ãƒ“ãƒ«ãƒ‰æ™‚é–“75-90%çŸ­ç¸® |

---

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:**
- [ãƒ‡ãƒ¼ã‚¿åŒæœŸæˆ¦ç•¥ã‚’ç¢ºèª](./data-synchronization-strategy.md)
- [ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰ã‚’ç¢ºèª](./deployment-guide.md)

