# 本番デプロイチェックリスト

> **統合済み:** 2025年11月9日より、デプロイ手順とチェックリストは `deployment-guide.md` に集約されました。最新手順はそちらを参照してください。本ファイルは履歴目的で保持しています。

**最終更新日**: 2025年10月19日  
**対象**: Phase 0A-4完了後の本番デプロイ  
**ステータス**: ✅ デプロイ準備完了

## 📋 デプロイ前チェックリスト

### 1. コード品質

- [x] **TypeScriptエラー**: すべて解決済み (`npx tsc --noEmit`)
- [x] **本番ビルド**: 成功 (`npm run build`)
- [x] **Lintエラー**: なし
- [x] **テスト**: 主要機能の動作確認済み

### 2. パフォーマンス検証

- [x] **TTFB**: 8ms（目標: <100ms）
- [x] **初期応答**: 即座にストリーミング開始
- [x] **検索時間**: 8.0秒（許容範囲）
- [x] **AI生成時間**: 19.1秒（Gemini API依存）
- [x] **総処理時間**: 27.3秒（実用的な範囲）

### 3. データ同期

- [x] **LanceDB**: Cloud Storageにアップロード済み（7.63 MB）
- [x] **ドメイン知識**: 最新版アップロード済み（4.16 MB）
- [x] **キャッシュ**: 最新版アップロード済み（39.2 MB）
- [x] **合計**: 50.99 MB、12ファイル

### 4. Git管理

- [x] **mainブランチ**: 最新版マージ済み
- [x] **バックアップ**: `backup-main-20251019-182855` 作成済み
- [x] **リモートプッシュ**: 完了
- [x] **コミットメッセージ**: 包括的な変更履歴記録

## 🚀 デプロイ手順

### ステップ1: 自動デプロイの確認

Firebase App Hostingを使用している場合、`main`ブランチへのpushで自動デプロイが開始されます。

```bash
# 既に完了済み
git push origin main
```

### ステップ2: ビルド状況の監視

**Firebase Consoleで確認**:
```
https://console.firebase.google.com/project/YOUR_PROJECT_ID/apphosting
```

**期待される所要時間**:
- ビルド: 約2-3分
- デプロイ: 約1-2分
- **合計**: 約3-5分

### ステップ3: デプロイ完了の確認

以下の項目を確認：

1. **ビルドログ**: エラーなし
2. **デプロイステータス**: 成功
3. **アプリケーションURL**: アクセス可能
4. **ヘルスチェック**: 正常応答

### ステップ4: 機能検証

#### 基本機能
- [ ] ログイン/認証
- [ ] チャット画面の表示
- [ ] ストリーミング応答の開始（即座に）
- [ ] 検索結果の表示
- [ ] 参照元の表示

#### パフォーマンス
- [ ] TTFB < 100ms
- [ ] 初期応答が即座に表示される
- [ ] ストリーミングがスムーズに動作
- [ ] 総処理時間が許容範囲内（<30秒）

#### 管理画面
- [ ] パフォーマンス指標の記録
- [ ] PostLogの保存
- [ ] グラフの表示
- [ ] 詳細ログの確認

## 📊 期待される改善効果

### ユーザー体験
```
✅ 初期応答時間:   284ms → 8ms    (-97%)
✅ ストリーミング:  即座に開始
✅ 処理状況表示:   リアルタイム更新
```

### 開発体験
```
✅ Fast Refresh:   13.5秒の遅延解消
✅ ビルドエラー:   すべて解決
✅ 型安全性:       向上
```

## 🔍 監視ポイント

### 初回デプロイ後30分

1. **エラーログ**: Firebase Consoleで確認
2. **パフォーマンス**: 管理画面で確認
3. **ユーザーフィードバック**: 初期反応を確認

### 最初の24時間

1. **エラー率**: 通常範囲内か
2. **応答時間**: 目標値を維持しているか
3. **キャッシュヒット率**: 向上しているか

### 1週間後

1. **安定性**: エラーが減少しているか
2. **パフォーマンス**: 一貫性があるか
3. **ユーザー満足度**: 改善されているか

## 🚨 トラブルシューティング

### デプロイ失敗時

1. **ビルドログ確認**: Firebase Consoleで詳細を確認
2. **ローカルビルド**: `npm run build` で再現
3. **ロールバック**: バックアップブランチから復元
   ```bash
   git checkout main
   git reset --hard backup-main-20251019-182855
   git push origin main --force
   ```

### パフォーマンス問題

1. **Cloud Storageデータ**: 正しくダウンロードされているか確認
2. **環境変数**: すべて設定されているか確認
3. **ログ確認**: 詳細なパフォーマンスログを確認

### 機能不具合

1. **エラーログ**: Firebase Consoleで確認
2. **ブラウザコンソール**: クライアント側エラーを確認
3. **ネットワークタブ**: API通信を確認

## 📝 デプロイ後の作業

### 即座に実施
- [ ] 基本機能の動作確認
- [ ] パフォーマンス指標の確認
- [ ] エラーログの確認

### 24時間以内
- [ ] 管理画面でPostLogデータを確認
- [ ] パフォーマンストレンドを分析
- [ ] ユーザーフィードバックを収集

### 1週間以内
- [ ] 安定性レポートの作成
- [ ] パフォーマンスレポートの作成
- [ ] 次期改善計画の策定

## 📌 重要な注意事項

1. **バックアップ**: 問題発生時に即座にロールバック可能
2. **監視**: デプロイ後は積極的に監視
3. **ドキュメント**: 問題や改善点を記録
4. **コミュニケーション**: チームへの報告を忘れずに

## 🎯 成功基準

このデプロイは以下の基準を満たした場合に成功とみなされます：

- ✅ TTFB < 100ms
- ✅ ストリーミング即座開始
- ✅ エラー率 < 1%
- ✅ 総処理時間 < 30秒
- ✅ ユーザー体験の向上

---

**担当者**: 開発チーム  
**レビュー**: 完了  
**承認**: 準備完了  
**デプロイ日時**: 2025年10月19日

