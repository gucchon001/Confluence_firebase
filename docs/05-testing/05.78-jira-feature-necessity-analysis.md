# Jira特性に基づく機能必要性分析

**作成日**: 2025-01-27  
**目的**: Jiraの特性を考慮して、Confluenceと同様の機能（タイトル救済検索、動的キーワード抽出、ラベルフィルタリング）が必要かどうかを判断

---

## 📋 分析概要

Confluenceで実装されている3つの機能について、Jiraの特性に基づいて必要性を判断します。

---

## 1. Phase 1: タイトル救済検索

### Confluenceの実装
- **目的**: タイトルがクエリに完全一致する場合に検索精度を向上
- **実装方法**: キーワードからタイトル候補を生成し、LIKE検索で救済
- **重み**: 検索結果の25%を占める重要機能

### Jiraの特性
- **課題タイトル（Summary）**: 各課題には`summary`フィールドがあり、これがタイトルとして機能
- **Issue Key**: `CTJ-1234`のような構造化された識別子
- **検索パターン**: ユーザーは「indeed対応」のようなタイトルや「CTJ-5439」のようなIssue Keyで検索することが多い

### 必要性判断: ✅ **必要**

**理由**:
1. **タイトル検索の重要性**: 課題管理では、タイトル（Summary）が課題の内容を端的に表すため、タイトル一致検索は検索精度向上に直結
2. **Issue Key検索**: 「CTJ-5439」のようなIssue Keyでの検索に対応することで、ユーザーの検索パターンに最適化
3. **パフォーマンス**: ベクトル検索で見つからない課題を、タイトル検索で救済することで、検索の網羅性が向上
4. **Confluenceとの一貫性**: 同様の機能があることで、ユーザー体験の一貫性が保たれる

**実装方針**:
- `title`フィールド（summary）でのLIKE検索
- Issue Keyでの完全一致検索を追加
- タイトル候補生成ロジックをJira用に調整

---

## 2. Phase 2: 動的キーワード抽出

### Confluenceの実装
- **目的**: ドメイン知識データベースから関連キーワードを抽出し、検索クエリを拡張
- **実装方法**: `keyword-lists-v2.json`からキーワードを抽出し、クエリに関連するものを追加
- **効果**: 検索精度の向上

### Jiraの特性
- **構造化フィールド**: ステータス、優先度、担当者、プロジェクトなどが構造化されている
- **カスタムフィールド**: 影響業務、業務影響度、GIG状況など、プロジェクト固有のフィールド
- **ドメイン知識**: Confluenceと同じドメイン知識データベースが利用可能

### 必要性判断: ✅ **必要**

**理由**:
1. **ドメイン知識の活用**: Confluenceと同じドメイン知識データベースからキーワードを抽出することで、プロジェクト固有の用語を検索に含められる
2. **構造化フィールドとの組み合わせ**: ステータス、優先度などの構造化フィールドと組み合わせることで、より精度の高い検索が可能
3. **現在部分的に動作**: 既にドメイン知識からの抽出は動作しているが、Jira特有のキーワード（ステータス、優先度など）の優先度設定が不十分

**実装方針**:
- 既存のドメイン知識抽出機能を活用
- Jira特有のキーワード（ステータス、優先度、カスタムフィールド値）の優先度を設定
- Issue Keyパターン（`CTJ-XXXX`）の検出を追加

---

## 3. Phase 3: ラベルフィルタリング

### Confluenceの実装
- **目的**: 議事録、アーカイブなどの不要なページを早期に除外
- **除外対象**: `['議事録', 'meeting-notes', 'アーカイブ', 'archive', 'フォルダ', 'スコープ外']`
- **実装場所**: 同期時の除外と、検索時の早期フィルタリング

### Jiraの特性
- **ラベルシステム**: Jiraにもラベル機能はあるが、使用頻度は低い
- **ステータスによる管理**: 課題の状態は主にステータス（「完了」「進行中」など）で管理
- **解決済み課題**: 解決済み（Resolved）やクローズ（Closed）の課題が多い
- **プロジェクトフィルタ**: プロジェクトキー（CTJ）で既にフィルタされている

### 必要性判断: ⚠️ **部分的に必要（ステータスベースのフィルタリング）**

**理由**:
1. **ラベルの使用頻度が低い**: Jiraではラベルよりもステータスで管理されることが多い
2. **ステータスベースのフィルタリングの方が有効**: 「完了」「クローズ済み」などのステータスでフィルタリングする方が実用的
3. **ただし、ラベルも存在する**: 一部の課題にはラベルが付いているため、ラベルフィルタリングも併用できると良い

**実装方針**:
- **ステータスベースのフィルタリング**を優先実装
  - 除外対象ステータス: `['完了', 'Resolved', 'Closed', 'Done']`（設定可能にする）
  - または、検索UIでステータスフィルタを提供
- **ラベルフィルタリング**はオプション
  - Confluenceと同じラベル除外ロジックを適用可能にするが、必須ではない
  - ラベルが付いている課題が少ないため、効果は限定的

**結論**: 
- **早期フィルタリングは必要**: ただし、ラベルではなくステータスベースで実装
- **ラベルフィルタリングは任意**: 将来的な拡張として実装可能

---

## 📊 総合判断

| 機能 | 必要性 | 優先度 | 実装方針 |
|------|--------|--------|----------|
| **Phase 1: タイトル救済検索** | ✅ **必要** | **高** | タイトル（Summary）+ Issue Key検索を実装 |
| **Phase 2: 動的キーワード抽出** | ✅ **必要** | **高** | 既存機能を活用 + Jira特有キーワードの優先度設定 |
| **Phase 3: ラベルフィルタリング** | ⚠️ **部分的に必要** | **中** | ステータスベースのフィルタリングを優先、ラベルは任意 |

---

## 🎯 推奨実装順序

1. **Phase 1: タイトル救済検索**（優先度: 最高）
   - 検索精度向上への影響が大きい
   - 実装が比較的シンプル

2. **Phase 2: 動的キーワード抽出の改善**（優先度: 高）
   - 既に部分的に動作しているため、改善のみで対応可能
   - Jira特有キーワードの優先度設定

3. **Phase 3: ステータスベースのフィルタリング**（優先度: 中）
   - ラベルではなくステータスでフィルタリング
   - 検索UIでのフィルタリング機能として実装するのが望ましい

---

## 💡 結論

**Phase 1とPhase 2は実装すべき**です。これらは検索精度向上に直接的に貢献し、Jiraの特性にも合致しています。

**Phase 3については、ラベルフィルタリングではなく、ステータスベースのフィルタリングを実装する方が実用的**です。ただし、これは検索UIでのフィルタリング機能として実装する方が、ユーザー体験の観点から望ましいかもしれません。

