# Kuromojiè¾æ›¸ãƒ‘ã‚¹è­¦å‘Šã®è§£æ¶ˆ

## ğŸš¨ å•é¡Œ

æœ¬ç•ªç’°å¢ƒã§ä»¥ä¸‹ã®è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ï¼š

```
[JapaneseTokenizer] âš ï¸  Primary path not found, using fallback: /workspace/.next/standalone/node_modules/kuromoji/dict
```

## åŸå› 

Firebase App Hostingã®å®Ÿè¡Œç’°å¢ƒã§ã¯ã€`process.cwd()`ãŒ`/workspace/.next/standalone`ã‚’è¿”ã—ã¾ã™ãŒã€`getDictionaryPath()`é–¢æ•°ãŒ`.next/standalone/node_modules/kuromoji/dict`ã‚’æ¢ãã†ã¨ã—ã¦ã€ç›¸å¯¾ãƒ‘ã‚¹ã®è§£æ±ºãŒæ­£ã—ãè¡Œã‚ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

## è§£æ±ºç­–

`japanese-tokenizer.ts`ã®`getDictionaryPath()`é–¢æ•°ã‚’ä¿®æ­£ã—ã¦ã€å®Ÿè¡Œæ™‚ã®`process.cwd()`ã«åŸºã¥ã„ã¦æ­£ã—ããƒ‘ã‚¹ã‚’è§£æ±ºã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

### ä¿®æ­£å†…å®¹

1. **å®Ÿè¡Œæ™‚ã®`process.cwd()`ã‚’è€ƒæ…®**
   - `/workspace/.next/standalone`ãŒç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å ´åˆã€`node_modules/kuromoji/dict`ã‚’ç›´æ¥æ¢ã™
   - `/workspace`ã‚’åŸºæº–ã«ã—ãŸçµ¶å¯¾ãƒ‘ã‚¹ã‚‚è©¦ã™

2. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯ã®æ”¹å–„**
   - è¤‡æ•°ã®ãƒ‘ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è©¦ã™
   - ã‚ˆã‚Šç¢ºå®Ÿã«è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹

## ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã®ç¢ºèªæ–¹æ³•

### Firebase Consoleã‹ã‚‰ç¢ºèª

1. [Firebase Console](https://console.firebase.google.com/project/confluence-copilot-ppjye/apphosting)ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒApp Hostingã€ã‚’é¸æŠ
3. æœ€æ–°ã®ãƒ“ãƒ«ãƒ‰ã‚’é¸æŠ
4. ã€Œãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã€ã‚¿ãƒ–ã‚’é–‹ã
5. ä»¥ä¸‹ã®ãƒ­ã‚°ã‚’æ¤œç´¢ï¼š
   ```
   [copy-kuromoji-dict]
   ```

### æœŸå¾…ã•ã‚Œã‚‹ãƒ­ã‚°å‡ºåŠ›

æˆåŠŸæ™‚ï¼š
```
> nextn@0.1.0 postbuild
> node scripts/copy-kuromoji-dict.js && node scripts/copy-lancedb-data.js

[copy-kuromoji-dict] Starting copy process...
[copy-kuromoji-dict] Source: /workspace/node_modules/kuromoji/dict
[copy-kuromoji-dict] Target: /workspace/.next/standalone/node_modules/kuromoji/dict
[copy-kuromoji-dict] âœ… Copied: base.dat.gz
[copy-kuromoji-dict] âœ… Copied: check.dat.gz
[copy-kuromoji-dict] âœ… Copied: cc.dat.gz
...
[copy-kuromoji-dict] âœ… Successfully copied 12 files
```

### gcloud CLIã‹ã‚‰ç¢ºèª

```powershell
# æœ€æ–°ã®ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã‚’å–å¾—
gcloud builds list --project=confluence-copilot-ppjye --limit=1

# ãƒ“ãƒ«ãƒ‰IDã‚’å–å¾—ã—ã¦ãƒ­ã‚°ã‚’è¡¨ç¤º
gcloud builds log BUILD_ID --project=confluence-copilot-ppjye | Select-String "copy-kuromoji-dict"
```

## æ¤œè¨¼æ–¹æ³•

ä¿®æ­£å¾Œã€ä»¥ä¸‹ã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œãªã„ã“ã¨ã‚’ç¢ºèªï¼š

```
[JapaneseTokenizer] âš ï¸  Primary path not found, using fallback
```

ä»£ã‚ã‚Šã«ã€ä»¥ä¸‹ã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªï¼š

```
[JapaneseTokenizer] âœ… Dictionary files verified at: /workspace/.next/standalone/node_modules/kuromoji/dict
```

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### è­¦å‘ŠãŒç¶šãå ´åˆ

1. **ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã§`copy-kuromoji-dict.js`ã®å®Ÿè¡Œã‚’ç¢ºèª**
   - ãƒ­ã‚°ã«`[copy-kuromoji-dict] âœ… Successfully copied`ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

2. **å®Ÿè¡Œæ™‚ã®ãƒ‘ã‚¹ã‚’ç¢ºèª**
   - ãƒ­ã‚°ã«`[JapaneseTokenizer] ğŸ”§ Initializing kuromoji tokenizer with path: ...`ãŒè¡¨ç¤ºã•ã‚Œã‚‹
   - è¡¨ç¤ºã•ã‚ŒãŸãƒ‘ã‚¹ãŒæ­£ã—ã„ã‹ç¢ºèª

3. **ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª**
   - ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã§è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚³ãƒ”ãƒ¼ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
   - å®Ÿè¡Œæ™‚ãƒ­ã‚°ã§è¾æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã£ã¦ã„ã‚‹ã‹ç¢ºèª

