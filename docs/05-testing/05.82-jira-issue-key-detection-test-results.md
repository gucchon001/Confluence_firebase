# Jira Issue Key検出テスト結果

**作成日**: 2025-01-27  
**ステータス**: 🔍 テスト実行中

---

## 📋 テスト結果のまとめ

### テストクエリ
- `CTJ-5439`
- `CTJ-4483`
- `CTJ-1453`

### 結果

1. **Issue Key検出**: ❓ 未確認（デバッグログが出力されていない）
2. **Issue Key検出ロジックの実行**: ❓ 未確認（デバッグログが出力されていない）
3. **検索結果**: ✅ Issue Keyは見つかっている（`Issue Key一致の結果: 1件`）
4. **完全一致検索マーカー**: ❌ 付いていない（`Issue Key完全一致検索の結果: 0件`）

---

## 🔍 問題点

### 1. デバッグログが出力されていない

以下のログが出力されていない：
- `[Title Rescue Search] tableName: ...`
- `[Title Rescue Search] Jira: Starting Issue Key detection for query: ...`
- `[Title Rescue Search] Jira: Detected Issue Keys in query: ...`

**可能性**:
- タイトル救済検索のセクション（448行目以降）が実行されていない
- `isJiraTable`が`false`になっている
- 何らかの条件でこのセクションがスキップされている

### 2. Issue Keyは見つかっているが、完全一致検索のマーカーが付いていない

**状況**:
- 検索結果にIssue Keyが含まれている（`Issue Key一致の結果: 1件`）
- しかし、`_issueKeyExact: true`マーカーが付いていない

**可能性**:
- タイトル救済検索ではなく、ベクトル検索やBM25検索で見つかっている
- Issue Key検出ロジックが実行されていない

---

## 🔧 修正済み項目

1. ✅ `DEBUG_SEARCH`の重複宣言を修正（`DEBUG_TITLE_SEARCH`に変更）
2. ✅ デバッグログを追加（`tableName`、`isJiraTable`の値を確認）

---

## 📝 次のステップ

1. ⏳ 修正後のコードでテストを再実行
2. ⏳ デバッグログの出力を確認
3. ⏳ 問題の原因を特定
4. ⏳ 修正を実装

---

## 🔗 関連ファイル

- `src/lib/lancedb-search-client.ts`: タイトル救済検索の実装
- `scripts/test-jira-issue-key-search.ts`: Issue Key検索テストスクリプト
- `scripts/debug-jira-issue-key-detection-in-search.ts`: Issue Key検出デバッグスクリプト

