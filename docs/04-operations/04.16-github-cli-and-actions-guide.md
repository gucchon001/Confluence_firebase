# GitHub CLIã¨GitHub Actionsé‹ç”¨ã‚¬ã‚¤ãƒ‰

**æœ€çµ‚æ›´æ–°**: 2025å¹´1æœˆ  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€GitHub CLIï¼ˆghï¼‰ã®ä½¿ç”¨æ–¹æ³•ã¨GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®é‹ç”¨æ–¹æ³•ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚

---

## ğŸ“‹ ç›®æ¬¡

1. [GitHub CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](#github-cliã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)
2. [GitHub CLIã®åŸºæœ¬æ“ä½œ](#github-cliã®åŸºæœ¬æ“ä½œ)
3. [GitHub Secretsã®ç®¡ç†](#github-secretsã®ç®¡ç†)
4. [GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼](#github-actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼)
5. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## GitHub CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### Windows (PowerShell)

#### æ–¹æ³•1: wingetã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰

```powershell
winget install --id GitHub.cli
```

#### æ–¹æ³•2: Chocolateyã‚’ä½¿ç”¨

```powershell
choco install gh
```

#### æ–¹æ³•3: Scoopã‚’ä½¿ç”¨

```powershell
scoop install gh
```

### macOS

```bash
brew install gh
```

### Linux

```bash
# Debian/Ubuntu
curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null
sudo apt update
sudo apt install gh
```

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã®ç¢ºèª

```bash
gh --version
```

### ãƒ‘ã‚¹ã®ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ï¼ˆWindowsï¼‰

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç›´å¾Œã€PowerShellã‚’å†èµ·å‹•ã™ã‚‹ã‹ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ‘ã‚¹ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ï¼š

```powershell
# æ–¹æ³•1: PowerShellã‚’å†èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰

# æ–¹æ³•2: ãƒ‘ã‚¹ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")

# æ–¹æ³•3: ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨
.\scripts\refresh-path.ps1
```

---

## GitHub CLIã®åŸºæœ¬æ“ä½œ

### èªè¨¼

#### ãƒ­ã‚°ã‚¤ãƒ³

```bash
gh auth login
```

å¯¾è©±å½¢å¼ã§ä»¥ä¸‹ã‚’é¸æŠï¼š
- GitHub.com ã¾ãŸã¯ GitHub Enterprise Server
- èªè¨¼æ–¹æ³•ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã€ãƒˆãƒ¼ã‚¯ãƒ³ãªã©ï¼‰
- ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆHTTPSæ¨å¥¨ï¼‰

#### èªè¨¼çŠ¶æ…‹ã®ç¢ºèª

```bash
gh auth status
```

#### ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ

```bash
gh auth logout
```

### ãƒªãƒã‚¸ãƒˆãƒªæ“ä½œ

#### ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
gh repo clone owner/repo
```

#### ãƒªãƒã‚¸ãƒˆãƒªæƒ…å ±ã®è¡¨ç¤º

```bash
gh repo view
```

---

## GitHub Secretsã®ç®¡ç†

### Secretsã®ä¸€è¦§è¡¨ç¤º

```bash
gh secret list
```

### Secretsã®è¨­å®š

#### å€‹åˆ¥ã«è¨­å®š

```bash
# æ–‡å­—åˆ—ã‚’è¨­å®š
gh secret set SECRET_NAME --body "secret-value"

# ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è¨­å®š
gh secret set SECRET_NAME < file.txt

# æ¨™æº–å…¥åŠ›ã‹ã‚‰è¨­å®š
echo "secret-value" | gh secret set SECRET_NAME
```

#### ä¾‹ï¼šJiraé–¢é€£ã®Secrets

```bash
# å¿…é ˆã®Secrets
gh secret set JIRA_PROJECT_KEY --body "CTJ"
gh secret set GEMINI_API_KEY --body "your-api-key"
gh secret set GOOGLE_CLOUD_CREDENTIALS < keys/firebase-adminsdk-key.json

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®Secrets
gh secret set JIRA_BASE_URL --body "https://giginc.atlassian.net"
gh secret set JIRA_USER_EMAIL --body "user@example.com"
gh secret set JIRA_API_TOKEN --body "your-token"
```

### Secretsã®å‰Šé™¤

```bash
gh secret delete SECRET_NAME
```

### Secretsã®æ›´æ–°

æ—¢å­˜ã®Secretã‚’æ›´æ–°ã™ã‚‹å ´åˆã¯ã€å†åº¦`gh secret set`ã‚’å®Ÿè¡Œã—ã¾ã™ï¼ˆä¸Šæ›¸ãã•ã‚Œã¾ã™ï¼‰ã€‚

### è‡ªå‹•è¨­å®šã‚¹ã‚¯ãƒªãƒ—ãƒˆ

`.env.local`ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‡ªå‹•çš„ã«Secretsã‚’è¨­å®šã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼š

**Windows (PowerShell):**
```powershell
.\scripts\setup-github-secrets.ps1
```

**macOS / Linux (Bash):**
```bash
chmod +x scripts/setup-github-secrets.sh
./scripts/setup-github-secrets.sh
```

---

## GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ä¸€è¦§

```bash
gh workflow list
```

### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡Œ

#### æ‰‹å‹•å®Ÿè¡Œ

```bash
# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ‰‹å‹•å®Ÿè¡Œ
gh workflow run WORKFLOW_NAME

# å…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®š
gh workflow run WORKFLOW_NAME --field sync_type=full
```

#### å®Ÿè¡Œå±¥æ­´ã®ç¢ºèª

```bash
# æœ€æ–°ã®å®Ÿè¡Œã‚’è¡¨ç¤º
gh run list

# ç‰¹å®šã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡Œã‚’è¡¨ç¤º
gh run list --workflow=WORKFLOW_NAME

# å®Ÿè¡Œã®è©³ç´°ã‚’è¡¨ç¤º
gh run view RUN_ID
```

#### å®Ÿè¡Œãƒ­ã‚°ã®è¡¨ç¤º

```bash
# æœ€æ–°ã®å®Ÿè¡Œã®ãƒ­ã‚°ã‚’è¡¨ç¤º
gh run view --log

# ç‰¹å®šã®å®Ÿè¡Œã®ãƒ­ã‚°ã‚’è¡¨ç¤º
gh run view RUN_ID --log
```

### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æœ‰åŠ¹åŒ–/ç„¡åŠ¹åŒ–

```bash
# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ç„¡åŠ¹åŒ–
gh workflow disable WORKFLOW_NAME

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æœ‰åŠ¹åŒ–
gh workflow enable WORKFLOW_NAME
```

### ç¾åœ¨ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

#### 1. ConfluenceåŒæœŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

**ãƒ•ã‚¡ã‚¤ãƒ«**: `.github/workflows/sync-confluence.yml`

- **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**: æ¯æ—¥åˆå‰2æ™‚ï¼ˆJST = UTC 17:00å‰æ—¥ï¼‰
- **æ‰‹å‹•å®Ÿè¡Œ**: å¯èƒ½ï¼ˆå·®åˆ†åŒæœŸã¾ãŸã¯å®Œå…¨åŒæœŸã‚’é¸æŠï¼‰
- **æ©Ÿèƒ½**:
  - Confluenceãƒ‡ãƒ¼ã‚¿ã®åŒæœŸ
  - Lunrã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å†æ§‹ç¯‰
  - LanceDBã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆ
  - Cloud Storageã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

**æ‰‹å‹•å®Ÿè¡Œ:**
```bash
gh workflow run sync-confluence.yml --field sync_type=differential
gh workflow run sync-confluence.yml --field sync_type=full
```

#### 2. JiraåŒæœŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

**ãƒ•ã‚¡ã‚¤ãƒ«**: `.github/workflows/sync-jira.yml`

- **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**: 30åˆ†ãŠãï¼ˆUTCæ™‚é–“ã®æ¯æ™‚0åˆ†ã¨30åˆ†ï¼‰
- **æ‰‹å‹•å®Ÿè¡Œ**: å¯èƒ½ï¼ˆæœ€å¤§å–å¾—ä»¶æ•°ã‚’æŒ‡å®šå¯èƒ½ï¼‰
- **æ©Ÿèƒ½**:
  - Jiraãƒ‡ãƒ¼ã‚¿ã®åŒæœŸ
  - Lunrã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®åˆæœŸåŒ–
  - LanceDBã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆ
  - Cloud Storageã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

**æ‰‹å‹•å®Ÿè¡Œ:**
```bash
gh workflow run sync-jira.yml --field max_issues=0
```

#### 3. é€±æ¬¡å®Œå…¨åŒæœŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

**ãƒ•ã‚¡ã‚¤ãƒ«**: `.github/workflows/weekly-full-sync.yml`

- **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**: æ¯é€±æ—¥æ›œæ—¥åˆå‰3æ™‚ï¼ˆJST = UTC 18:00åœŸæ›œæ—¥ï¼‰
- **æ‰‹å‹•å®Ÿè¡Œ**: å¯èƒ½
- **æ©Ÿèƒ½**:
  - Confluenceãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨åŒæœŸ
  - Lunrã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å†æ§‹ç¯‰
  - LanceDBã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆ
  - Cloud Storageã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

**æ‰‹å‹•å®Ÿè¡Œ:**
```bash
gh workflow run weekly-full-sync.yml
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### GitHub CLIé–¢é€£

#### å•é¡Œ1: `gh`ã‚³ãƒãƒ³ãƒ‰ãŒèªè­˜ã•ã‚Œãªã„

**ç—‡çŠ¶:**
```
gh : ç”¨èª 'gh' ã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã€é–¢æ•°ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ•ã‚¡ã‚¤ãƒ«ã€ã¾ãŸã¯æ“ä½œå¯èƒ½ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®åå‰ã¨ã—ã¦èªè­˜ã•ã‚Œã¾ã›ã‚“
```

**è§£æ±ºæ–¹æ³•:**

1. **PowerShellã‚’å†èµ·å‹•**ï¼ˆæ¨å¥¨ï¼‰
2. **ãƒ‘ã‚¹ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥:**
   ```powershell
   $env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")
   ```
3. **ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨:**
   ```powershell
   .\scripts\refresh-path.ps1
   ```

#### å•é¡Œ2: èªè¨¼ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶:**
```
You are not logged into any GitHub hosts
```

**è§£æ±ºæ–¹æ³•:**
```bash
gh auth login
```

#### å•é¡Œ3: æ¨©é™ã‚¨ãƒ©ãƒ¼

**ç—‡çŠ¶:**
```
insufficient permissions
```

**è§£æ±ºæ–¹æ³•:**
- GitHub CLIã®èªè¨¼æ™‚ã«é©åˆ‡ãªã‚¹ã‚³ãƒ¼ãƒ—ã‚’é¸æŠ
- ãƒªãƒã‚¸ãƒˆãƒªã¸ã®é©åˆ‡ãªæ¨©é™ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèª

### GitHub Actionsé–¢é€£

#### å•é¡Œ1: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒå®Ÿè¡Œã•ã‚Œãªã„

**ç¢ºèªäº‹é …:**
1. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹
   ```bash
   gh workflow list
   ```
2. ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹
3. ãƒ–ãƒ©ãƒ³ãƒãŒæ­£ã—ã„ã‹ï¼ˆé€šå¸¸ã¯`main`ã¾ãŸã¯`master`ï¼‰

#### å•é¡Œ2: SecretsãŒè¦‹ã¤ã‹ã‚‰ãªã„

**ç—‡çŠ¶:**
```
Secret 'SECRET_NAME' was not found
```

**è§£æ±ºæ–¹æ³•:**
1. SecretsãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
   ```bash
   gh secret list
   ```
2. Secretåã®ã‚¿ã‚¤ãƒã‚’ç¢ºèª
3. ãƒªãƒã‚¸ãƒˆãƒªãŒæ­£ã—ã„ã‹ç¢ºèª

#### å•é¡Œ3: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡ŒãŒå¤±æ•—ã™ã‚‹

**ç¢ºèªæ–¹æ³•:**
```bash
# æœ€æ–°ã®å®Ÿè¡Œã‚’ç¢ºèª
gh run list

# å¤±æ•—ã—ãŸå®Ÿè¡Œã®ãƒ­ã‚°ã‚’ç¢ºèª
gh run view RUN_ID --log
```

**ã‚ˆãã‚ã‚‹åŸå› :**
- Secretsã®å€¤ãŒé–“é•ã£ã¦ã„ã‚‹
- ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„
- ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«å¤±æ•—
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

---

## ä¾¿åˆ©ãªã‚³ãƒãƒ³ãƒ‰é›†

### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼é–¢é€£

```bash
# ã™ã¹ã¦ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡ŒçŠ¶æ³ã‚’ç¢ºèª
gh run list --limit 10

# å¤±æ•—ã—ãŸå®Ÿè¡Œã®ã¿è¡¨ç¤º
gh run list --status failure

# å®Ÿè¡Œã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«
gh run cancel RUN_ID

# å®Ÿè¡Œã‚’å†å®Ÿè¡Œ
gh run rerun RUN_ID
```

### Secretsé–¢é€£

```bash
# Secretsã®ä¸€è¦§ã‚’è¡¨ç¤ºï¼ˆå€¤ã¯è¡¨ç¤ºã•ã‚Œãªã„ï¼‰
gh secret list

# ç‰¹å®šã®SecretãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
gh secret list | grep SECRET_NAME
```

### ãƒªãƒã‚¸ãƒˆãƒªé–¢é€£

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã®æƒ…å ±ã‚’è¡¨ç¤º
gh repo view

# ãƒªãƒã‚¸ãƒˆãƒªã®è¨­å®šã‚’è¡¨ç¤º
gh repo view --json name,description,url
```

---

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Jiraæœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰](./04.15-jira-production-deployment-guide.md)
- [ãƒ‡ãƒ¼ã‚¿åŒæœŸæˆ¦ç•¥](./04.03-data-synchronization-strategy.md)
- [ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰](./04.01-deployment-guide.md)

---

## æ›´æ–°å±¥æ­´

- **2025å¹´1æœˆ**: åˆç‰ˆä½œæˆ
  - GitHub CLIã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †
  - GitHub Secretsã®ç®¡ç†æ–¹æ³•
  - GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®é‹ç”¨æ–¹æ³•
  - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰

---

