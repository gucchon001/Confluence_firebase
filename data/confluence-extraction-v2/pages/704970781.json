{
  "id": "704970781",
  "title": "593_【FIX】応募管理 - 詳細 - メッセージ - 新規作成機能",
  "content": "1. 目次 1 6 false list false 2. 概要 本機能は 【FIX】応募メッセージ情報 の登録済みのデータを1件新規追加するための機能です。 3. 要求事項 クライアント企業向け管理画面にログインできるクライアント企業管理者のみが、 【FIX】応募メッセージ情報 のデータを新規登録することができる。 新規登録にあたって入力フォームに表示し 入力可能な項目 は以下の通り。 本ページの 「要件定義」-「入力」欄 で入力元が「入力フォーム」と定義されている項目 キャンセルボタン 送信するボタン 送信するボタンを押下すると入力項目に問題なければ、 送信確認モーダルを表示する 。モーダルには「キャンセル」ボタンと「送信する」ボタンを設置する。キャンセルボタンを押下するとモーダルを閉じる。 モーダル内の送信するボタンを押下すると、 以下の条件を満たしているかを確認する。1つでも満たしていなかった場合、モーダルを閉じた上で、それぞれに応じたエラーメッセージを含むポップアップを表示する 。 対象の応募者が応募から180日以上経過している 「応募から180日以上が経過しているためメッセージを送ることができません。」 対象の応募者が応募情報を修正している 「応募者が応募情報を編集したためメッセージを送ることができません。」 対象の応募者が塾講師ステーションを退会している 「応募者が塾講師ステーションを退会しているためメッセージを送ることができません。」 条件を全て満たしていた場合、データベースにレコードを保存し、 【作成中】メッセージ受信通知メール（会員宛） を送信し、モーダルを閉じた上で送信完了のポップアップを表示する。ポップアップには「送信が完了しました。」と表示し、閉じるボタンを押下すると 592_【FIX】応募管理 - 詳細 - メッセージ - 一覧閲覧機能 に遷移する。 入力内容に問題がある場合は、同入力フォームページのフォームに入力された値を表示した状態で、どの入力項目に問題があるかわかるようにエラーメッセージを表示する。 キャンセルボタンを押下すると 592_【FIX】応募管理 - 詳細 - メッセージ - 一覧閲覧機能 に遷移する。 メール送信に成功または失敗した場合、以下の情報が入ったログを出力する。 日時、管理者ID、アクセス元IPアドレス、ユーザーエージェント、アクション（成功or失敗） 3.1. 権限 要求に同じ。 3.2. 帳票 概要に同じ。 3.3. メールテンプレート 【作成中】メッセージ受信通知メール（会員宛） 3.4. ワークフロー 【FIX】オファー・応募・選考・採用フロー 4. 要件定義 4.1. ユーザーインターフェース（画面） 4.1.1. 新規作成画面 https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=99385-60795&amp;mode=design&amp;t=6uLBHyVExE7hZ2SH-0 4.2. 入力 変数名、説明、バリデーションは、帳票の記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 変数名 入力元 説明 制限 1 件名 &nbsp; 入力フォーム 初期値なし 必須 2 本文 &nbsp; 入力フォーム 初期値なし 必須 テキストエリアとし、入力枠の高さを任意で広げられるようにする。 3 メッセージテンプレート &nbsp; 入力フォーム 初期値＝▼選択してください 選択肢は 【作成中】企業：メッセージテンプレート のものとする。 選択すると、そのテンプレートの内容を件名と本文に出力する。 4.3. 出力 変数名、説明、バリデーションは、帳票の記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 出力先 説明 1 宛先 画面 宛先の会員の姓名を表示する。 2 件名 データベース/画面 メッセージテンプレートが選択された場合は、そのテンプレートの件名を出力する。 入力妥当性検査によるエラー発生時は画面の対象フォーム内にHTMLエスケープ処理をして出力、エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 3 本文 データベース/画面 メッセージテンプレートが選択された場合は、そのテンプレートの本文を出力する。 入力妥当性検査によるエラー発生時は画面の対象フォーム内にHTMLエスケープ処理をして出力、エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 4 メッセージテンプレート 画面 入力妥当性検査によるエラー発生時は画面の対象フォーム内に、入力された値が指し示す選択肢が選択された状態で表示する。 5 ユーザー番号 データベース 宛先の会員のユーザー番号を登録する。 6 応募番号 データベース 紐づく応募の応募番号を登録する。 7 既読日時 データベース 空とする。 8 送信時間 データベース 送信された時間を登録する。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合は全体管理者画面のログイン画面にリダイレクトし、ログイン認証されているが権限の章に記載した権限を持っていない場合は全体管理者画面のTOP画面にリダイレクトする。 4.4.1. 入力画面表示処理 本ページの「入力」に記載の全ての項目の入力フォームと登録ボタンを配置した画面を表示する。 4.4.2. 新規登録処理 入力フォームからのデータを受け取り、「入力」の定義にしたがって値の妥当性検査をおこなう。 入力項目値の妥当性に問題があった場合は、どの項目にどのような問題が発生したかわかるようにエラーメッセージを表示し、入力された値を入力フォーム内に表示・選択された状態で画面を出力して処理を終了する。 入力項目値の妥当性に問題がない場合は、入力された項目値と、作成日時、更新日時を操作している現在時刻とし、操作を行なっているクライアント管理者のユーザー番号を作成者/更新者に設定した上でデータベースに新規レコードとして挿入する。 新規データ登録が完了したことがわかるようにポップアップを表示し、 592_【FIX】応募管理 - 詳細 - メッセージ - 一覧閲覧機能 へリダイレクトする。 4.5. エラー処理 上記以外で発生した例外に関してはフレームワークの例外処理に任せる。 4.6. ログ 新規登録処理（メール送信処理） を実行した場合に下記フォーマットでログを出力する。 データベースへの登録 に成功した場合 User {クライアント管理者のユーザー番号} created message for user. company_number={企業番号} user_number={宛先のユーザー番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} データベースへの登録に失敗した場合 User {クライアント管理者のユーザー番号} failed to create message for user. company_number={企業番号} user_number={宛先のユーザー番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} メール送信に成功した場合 User {クライアント管理者のユーザー番号} sent email for user. company_number={企業番号} user_number={宛先のユーザー番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} メール送信に失敗した場合 User {クライアント管理者のユーザー番号} failed to send email for user. company_number={企業番号} user_number={宛先のユーザー番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. スコープ外・制限事項 CTJ-2122 0f376871-0459-35fc-b139-2a34c915ec22 System JIRA より下書き機能は実装しない。",
  "parentId": "727974168",
  "parentTitle": "595_【作成中】応募管理 - 詳細 - メッセージ管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/704970781/593_+FIX+-+-+-",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2024-01-30T09:04:18.556Z",
  "author": "元ユーザー (Deleted)",
  "excerpt": "1. 目次 1 6 false list false 2. 概要 本機能は 【FIX】応募メッセージ情報 の登録済みのデータを1件新規追加するための機能です。 3. 要求事項 クライアント企業向け管理画面にログインできるクライアント企業管理者のみが、 【FIX】応募メッセージ情報 のデータを新規登録することができる。 新規登録にあたって入力フォームに表示し 入力可能な項目 は以下の通り。 本ページ..."
}