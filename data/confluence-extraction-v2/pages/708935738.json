{
  "id": "708935738",
  "title": "121_【FIX】企業一覧閲覧機能",
  "content": "1. 目次 2. 概要 本機能は 【FIX】企業：基本情報 【FIX】企業：設定情報（全体管理者向け） 【FIX】企業：設定情報（クライアント企業向け） の登録済みのデータの一覧を閲覧するための機能です。 3. 要求事項 管理画面にログインできるシステム管理者、塾講師ステーション管理者、ゲスト管理者のみが、概要で挙げた帳票に登録されたデータを一覧で閲覧することができる。 1ページあたりの表示数を50件とし、表示対象のレコードが51件以上の場合は、 ページネーション (ページ移動のためのコンポーネント）と現在のページ数、総ページ数を一覧の上部と下部に表示する。 存在しないページを指定した場合は1ページ目 を表示する。 登録日時の降順で表示し、並べ替えを行うことはできなくて良い。 一覧フィルターの上に次のボタンを表示する 新規登録ボタン 押下すると 122_【FIX】企業新規登録機能 に遷移する。 全企業CSVダウンロード 押下すると 126_企業情報CSVダウンロード機能 を実行する。 担当者情報一括CSVダウンロード 押下すると 129_企業担当者情報CSV一括ダウンロード機能 を実行する。 企業群一括変更CSVアップロード 押下すると 127_CSVアップロード - 企業群一括変更機能 に遷移する。 一覧フィルター用コンポーネントの表示項目は 下記の通り で、全てAND結合とし、「絞り込み」ボタンを表示するまで フィルター項目 の変更は適用されないものとする。 本ページの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/708935738#4.2.-%E5%85%A5%E5%8A%9B で入力元として「入力フォーム：フィルター」が定義されている項目 検索ボタン &rdquo;条件から企業CSVダウンロード&rdquo;ボタン 検索ボタンを押下することで変更されたフィルター項目の一覧適用を実行する。検索結果が1件もなかった場合は、「該当する企業が見つかりませんでした」と表示する。 条件から企業CSVダウンロードボタンを押下することで、押下すると 126_企業情報CSVダウンロード機能 を実行する。検索結果が1件もなかった場合は ダウンロードは実行されず、データがありません、とポップアップを表示する 。ポップアップには閉じるボタンを配置し、ボタンを押下するとポップアップを閉じる。 一覧の各レコードには 以下の項目 を表示する。 本ページの 「要件定義」-「 出力 」欄 で出力先として「画面」が定義されている項目のうち、企業情報レコードとして定義されている項目 編集ボタン 押下すると 123_【FIX】企業編集機能 に遷移する。 削除ボタン 押下すると 124_【FIX】企業削除機能 へ遷移する。 急募ボタン 押下すると 185_急募新規登録機能 を別タブで開く。 集計ボタン 押下すると 128_教室毎アクセス集計期間設定機能 へ遷移する。 3.1. 権限 管理画面にログインできるシステム管理者、塾講師ステーション管理者、ゲスト管理者のみ 3.2. 帳票 120_【FIX】企業管理機能 の記載と同じ 3.3. メールテンプレート なし 3.4. ワークフロー 120_【FIX】企業管理機能 の記載と同じ 3.4.1. 本機能 3.4.2. 関連 4. 要件定義 4.1. ユーザーインターフェース（画面） https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=2109-34437&amp;t=nGyEaqDZcand6mWG-4 4.2. 入力 変数名、説明、バリデーションは、 【FIX】企業：基本情報 【FIX】企業：設定情報（全体管理者向け） 【FIX】企業：設定情報（クライアント企業向け） 各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 変数名 入力元 説明 制限とエラーメッセージ 1 ページ番号 &hellip; URLパラメータ &hellip; &hellip; 2 企業コード 入力フォーム：フィルター、URLパラメータ 1行テキストボックスで入力し、 【FIX】企業：基本情報 の「企業コード」を完全一致でフィルタリングする。 初期状態 は最後に入力したものを表示する。前に入力されたものがない場合は空欄を表示する。 任意項目。入力されていない場合はフィルタリングをおこなわない。 3 企業名 入力フォーム：フィルター、URLパラメータ 1行テキストボックスで入力し、 【FIX】企業：基本情報 の「企業名」を部分一致でフィルタリングする。 最大文字数は30文字、単一入力のみ受け付ける。最大文字数を超えた検索の場合は最初の30文字で検索をかける。 初期状態は最後に入力したものを表示する。前に入力されたものがない場合は空欄を表示する。 任意項目。入力されていない場合はフィルタリングをおこなわない。 4 教室グループ名 入力フォーム：フィルター、URLパラメータ 1行テキストボックスで入力し、 【FIX】教室グループ の「教室グループ名」を部分一致でフィルタリングする。 最大文字数は50文字とし、それを超えた場合の検索は最初の50文字で検索をかける。半角または全角スペース区切りで3単語まで複数単語の入力を受け付け、AND検索とする。 初期状態は最後に入力したものを表示する。前に入力されたものがない場合は空欄を表示する。 任意項目。入力されていない場合はフィルタリングをおこなわない。 5 管理メモ1 入力フォーム：フィルター、URLパラメータ 1行テキストボックスで入力し、 【FIX】企業：基本情報 の「管理メモ1」を部分一致でフィルタリングする。 最大文字数は50文字とし、それを超えた場合の検索は最初の50文字で検索をかける。半角または全角スペース区切りで5単語まで 複数単語 の入力を受け付け、AND検索とする。 初期状態は最後に入力したものを表示する。前に入力されたものがない場合は空欄を表示する。 任意項目。入力されていない場合はフィルタリングをおこなわない。 6 管理メモ2 入力フォーム：フィルター、URLパラメータ 1行テキストボックスで入力し、 【FIX】企業：基本情報 の「管理メモ2」を部分一致でフィルタリングする。 最大文字数は50文字とし、それを超えた場合の検索は最初の50文字で検索をかける。半角または全角スペース区切りで5単語まで複数単語の入力を受け付け、AND検索とする。 初期状態は最後に入力したものを表示する。前に入力されたものがない場合は空欄を表示する。 任意項目。入力されていない場合はフィルタリングをおこなわない。 4.3. 出力 説明は、 【FIX】企業：基本情報 【FIX】企業：設定情報（全体管理者向け） 【FIX】企業：設定情報（クライアント企業向け） 各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 出力項目 出力先 説明 1 件数 画面 指定されたフィルタリングを適用した結果表示可能なデータの総件数をページ上部に表示する。 2 総ページ数 画面 指定されたフィルタリングを適用した結果の件数に対して１ページあたり50件の表示で計算した総ページ数をページ上部に表示する。 3 ページ番号 画面 入力されたページ番号を入力処理にて変換した値をページ上部に表示する。 4 企業コード 画面 入力された「企業コード」を入力処理にて変換した値を、フィルター用コンポーネント内の「企業コード」のテキストボックスに表示する。 5 企業名 画面 入力された「企業名」を入力処理にて変換した値を、フィルター用コンポーネント内の「企業名」のテキストボックスに適切なHTMLエスケープ処理を施して表示する。 6 教室グループ名 画面 入力された「教室グループ名」を入力処理にて変換した値を、フィルター用コンポーネント内の「教室グループ名」のテキストボックスに適切なHTMLエスケープ処理を施して表示する。 7 管理メモ1 画面 入力された「管理メモ1」を入力処理にて変換した値を、フィルター用コンポーネント内の「管理メモ1」のテキストボックスに適切なHTMLエスケープ処理を施して表示する。 8 管理メモ2 画面 入力された「管理メモ2」を入力処理にて変換した値を、フィルター用コンポーネント内の「管理メモ2」のテキストボックスに適切なHTMLエスケープ処理を施して表示する。 9 企業情報配列 画面 指定されたフィルタリングを適用してデータベースから抽出した企業情報レコードの配列をテーブル組みでページ上に表示する。各レコードの表示データは以下「企業情報：」プレフィックスで始まる出力項目として説明する。 10 企業情報：企業コード 画面 データベースから取得した企業情報1レコードの「企業コード」を表示する。 125_【FIX】企業詳細閲覧機能 にハイパーリンクする。詳細は 【FIX】企業：基本情報 を参照。 11 企業情報：企業番号 画面 データベースから取得した企業情報1レコードの「企業番号」を表示する。 125_【FIX】企業詳細閲覧機能 にハイパーリンクする。詳細は 【FIX】企業：基本情報 を参照。 12 企業情報：企業名 画面 データベースから取得した企業情報1レコードの「企業名」を適切にHTMLエスケープして表示する。詳細は 【FIX】企業：基本情報 を参照。 13 企業情報： 住所 画面 データベースから取得した企業情報1レコードの「都道府県」を、適切にHTMLエスケープして表示する。詳細は 【FIX】企業：基本情報 を参照。 14 企業情報： 管理メモ1 画面 データベースから取得した企業情報1レコードの「管理メモ1」の最初の5文字を適切にHTMLエスケープして表示する。詳細は 【FIX】企業：基本情報 を参照。 15 企業情報： 管理メモ2 画面 データベースから取得した企業情報1レコードの「管理メモ2」の最初の10文字を適切にHTMLエスケープして表示する。詳細は 【FIX】企業：基本情報 を参照。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合は全体管理者画面のログイン画面にリダイレクトし、ログイン認証されているが権限の章に記載した権限を持っていない場合は全体管理者画面のTOP画面にリダイレクトする。 「企業コード」「企業名」「教室グループ名」「管理メモ1」「管理メモ2」の入力処理をおこなう。 入力された全ての条件をAND結合して 121-2_【FIX】企業検索API を用いてデータベースから条件に合致したレコードの総件数を取得する。 レコードの総件数が20,000を超えていた場合、 以降は総件数を20,000件として処理を続行する 。 レコードの総件数からページ総数を計算し、「ページ番号」の入力がページ総数を超えていた場合、自然数以外を表す文字列だった場合は以降はページ番号=1として処理をおこなう。 レコードの総件数が0件だった場合、データの抽出を実行しないで0件の企業データ配列を生成する。 レコードの総件数が1件以上だった場合、上記の条件をもとにして登録日時の降順に並べて、指定されたページ番号に表示すべき企業情報50件のデータを 121-2_【FIX】企業検索API を用いてデータベースから抽出する。 出力の章に記載した出力項目をページ表示できるよう整形し、ページを出力する。 4.5. エラー処理 入力処理でエラーは発生させない。 それ以外で発生した例外に関してはフレームワークの例外処理に任せる。 4.6. ログ 一覧を表示した場合に下記フォーマットでログを出力する User {全体管理者のユーザー番号} read company list . page={ページ番号} company_code={企業コード} company_name={企業名} brand _name ={教室グループ名} admin_note_1={管理メモ1} admin_note_2={管理メモ2} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. スコープ外・制限事項 並べ替え(ソート)機能は提供しない。 最後に閲覧していた 121_【FIX】企業一覧閲覧機能 のページに戻るための機能はアプリケーションでは提供しない。",
  "parentId": "704675888",
  "parentTitle": "120_【FIX】企業管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/708935738/121_+FIX",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2023-08-23T00:39:01.423Z",
  "author": "ejiri_yusuke",
  "excerpt": "1. 目次 2. 概要 本機能は 【FIX】企業：基本情報 【FIX】企業：設定情報（全体管理者向け） 【FIX】企業：設定情報（クライアント企業向け） の登録済みのデータの一覧を閲覧するための機能です。 3. 要求事項 管理画面にログインできるシステム管理者、塾講師ステーション管理者、ゲスト管理者のみが、概要で挙げた帳票に登録されたデータを一覧で閲覧することができる。 1ページあたりの表示数を5..."
}