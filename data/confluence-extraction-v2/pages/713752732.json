{
  "id": "713752732",
  "title": "101_【FIX】商品一覧閲覧機能",
  "content": "1. 目次 2. 概要 本機能は 【FIX】商品マスタ（統合版） の登録済みのデータの一覧を閲覧するための機能です。 3. 要求事項 全体管理画面にログインすることができる システム管理者、塾ステーション管理者 のみが、登録されている 【FIX】商品マスタ（統合版） 一覧で閲覧することができる。 一覧ページ上部には、下記を表示する。 一覧フィルター用コンポーネント 表示可能なレコードの総数 新規登録ボタン 押下すると 102_【FIX】商品新規追加機能 に遷移する。 公開/非公開ボタン 押下することで、現在ページに表示されておりチェックが入った商品を全て公開状態に、チェックが入っていない商品を全て非公開状態にすることができる。 １ページあたりの表示数を50件とし、表示対象のレコードが51件以上の場合は、ページネーション（ページ移動のためのコンポーネント）と現在のページ数、総ページ数を一覧の上部と下部に表示する。 登録日時の降順で表示し、並べ替えを行うことはできなくて良い。 一覧フィルター用コンポーネントの表示項目は下記の通りで全てAND結合とし、「絞り込み」ボタンを押下するまでフィルター項目の変更は適用されないものとする。 絞り込み ボタン。押下することで変更されたフィルター項目の一覧適用を実行する。 検索結果が1件もなかった場合は、「該当する商品が見つかりませんでした」と表示する。 本ページの「要件定義」-「入力」欄（ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/713752732#4.2.-%E5%85%A5%E5%8A%9B ）で入力元として「入力フォーム」が定義されている項目の内、「フィルター項目」として定義されている項目。 一覧の各レコードには 本ページの「要件定義」-「出力」欄（ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/713752732#4.3.-%E5%87%BA%E5%8A%9B ）で出力先として「画面」が定義されている項目の内、商品情報レコードとして定義されている項目 を表示する。 3.1. 権限 システム管理者、塾ステーション管理者のみ 3.2. 帳票 100_【FIX】商品管理機能 の記載と同じ 3.3. メールテンプレート なし 3.4. ワークフロー 100_【FIX】商品管理機能 の記載と同じ 4. 要件定義 4.1. ユーザーインターフェース（画面） 4.1.1. 商品一覧画面 https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=1833%3A28876&amp;t=D8l394sON9r4knNS-1 4.2. 入力 100_【FIX】商品管理機能 に記載の共通入力・取得項目は省略する。 項目名 変数名 入力元 説明 制限とエラーメッセージ 1 全てのレコードを表示 showall URLパラメータ 全てのレコードを表示するかどうかを指定する真偽値。True（大文字小文字問わず）が指定された場合は削除済みレコードも表示し、True以外の値の場合は削除済みレコードはフィルタする。 True以外の値の場合はFalseと判定する。どんな値でもエラーは発生させない。 任意項目。入力されていない場合はFalseと判定する。 2 対象サイト service URLパラメータ／入力フォーム フィルター項目 単一選択のセレクトボックス で入力し、 【FIX】商品マスタ（統合版） の「対象サイト」に記載されている選択肢と「すべて」から選択することができる。 デフォルトは「すべて」。 【FIX】商品マスタ（統合版） の「対象サイト」に記載されている選択肢以外が入力された場合は「すべて」と判定し、どんな値が入力されてもエラーは発生させない。 任意項目。入力されていない場合は「すべて」と判定しフィルタリングはおこなわない。 3 商品種別 type URLパラメータ／入力フォーム フィルター項目 単一選択のセレクトボックスで入力し、 【FIX】商品マスタ（統合版） の「商品種別」に記載されている選択肢と「すべて」から選択することができる。 デフォルトは「すべて」。 【FIX】商品マスタ（統合版） の「商品種別」に記載されている選択肢以外が入力された場合は「すべて」と判定し、どんな値が入力されてもエラーは発生させない。 任意項目。入力されていない場合は「すべて」と判定しフィルタリングはおこなわない。 4 購入可フラグ is_available URLパラメータ／入力フォーム フィルター項目 単一選択のセレクトボックスで入力し、 【FIX】商品マスタ（統合版） の「購入可フラグ」に記載されている選択肢と「すべて」から選択することができる。 デフォルトは「購入可」。 【FIX】商品マスタ（統合版） の「購入可フラグ」に記載されている選択肢以外が入力された場合は「すべて」と判定し、どんな値が入力されてもエラーは発生させない。 任意項目。入力されていない場合は「すべて」と判定しフィルタリングはおこなわない。 5 公開フラグ is_opened URLパラメータ／入力フォーム フィルター項目 単一選択のセレクトボックスで入力し、 【FIX】商品マスタ（統合版） の「公開フラグ」に記載されている選択肢と「すべて」から選択することができる。 デフォルトは「すべて」。 【FIX】商品マスタ（統合版） の「公開フラグ」に記載されている選択肢以外が入力された場合は「すべて」と判定し、どんな値が入力されてもエラーは発生させない。 任意項目。入力されていない場合は「すべて」と判定しフィルタリングはおこなわない。 6 ページ番号 page URLパラメータ 一覧のページネーションで表示するページを指定するページ番号。自然数の数字で指定する。 入力がない場合、自然数に変換不可能な文字列が入力された場合、存在しないページ番号が指定された場合はいずれもページ番号を1として処理を行う。 自然数以外が入力された場合は1として処理しエラーは発生させない。 存在しないページ番号が指定された場合は1として処理しエラーは発生させない。 4.3. 出力 出力項目 出力先 説明 1 件数 画面 指定されたフィルタリングを適用した結果表示可能なデータの総件数をページ上部に表示する。 2 総ページ数 画面 指定されたフィルタリングを適用した結果の件数に対して１ページあたり50件の表示で計算した総ページ数をページ上部に表示する。 3 ページ番号 画面 入力されたページ番号を入力処理にて変換した値をページ上部に表示する。 4 対象サイト 画面 入力された「対象サイト」を入力処理にて変換した値を利用し、フィルター用コンポーネント内の「対象サイト」のセレクトボックスで初期選択状態とする。 5 商品種別 画面 入力された「商品種別」を入力処理にて変換した値を利用し、フィルター用コンポーネント内の「商品種別」のセレクトボックスで初期選択状態とする。 6 購入可フラグ 画面 入力された「購入可フラグ」を入力処理にて変換した値を利用し、フィルター用コンポーネント内の「購入可フラグ」のセレクトボックスで初期選択状態とする。 7 公開フラグ 画面 入力された「公開フラグ」を入力処理にて変換した値を利用し、フィルター用コンポーネント内の「公開フラグ」のセレクトボックスで初期選択状態とする。 8 商品情報配列 画面 指定されたフィルタリングを適用してデータベースから抽出した商品情報レコードの配列をテーブル組みでページ上に表示する。各レコードの表示データは以下「商品情報：」プレフィックスで始まる出力項目として説明する。 9 商品情報：商品番号 画面 データベースから取得した商品情報1レコードの「商品番号」。登録された「番号」を変換せずにそのまま表示する。詳細は 【FIX】商品マスタ（統合版） を参照。 10 商品情報：商品ID 画面 データベースから取得した商品情報1レコードの「商品ID」。登録された「商品ID」文字列を変換せずにそのまま表示し、 103_【FIX】商品詳細閲覧機能 にハイパーリンクする。詳細は 【FIX】商品マスタ（統合版） を参照。 11 商品情報：購入可フラグ 画面 データベースから取得した商品情報1レコードの「購入可フラグ」。購入可状態なら網掛けなしの状態、購入不可状態なら網掛けありの状態でレコード行を表示する。詳細は 【FIX】商品マスタ（統合版） を参照。 12 商品情報：公開フラグ 画面 データベースから取得した商品情報1レコードの「公開フラグ」。フラグのラベルを表示する。詳細は 【FIX】商品マスタ（統合版） を参照。 13 商品情報：単価 画面 データベースから取得した商品情報1レコードの「単価」を３桁カンマ区切りの数字で表示する。詳細は 【FIX】商品マスタ（統合版） を参照。 14 商品情報：商品種別 画面 データベースから取得した商品情報1レコードの「商品種別」を設定ファイルから取得した商品種別選択肢のラベルで表示する。詳細は 【FIX】商品マスタ（統合版） を参照。 15 商品情報： 課金形態種別 画面 データベースから取得した商品情報1レコードの「課金形態種別」を設定ファイルから取得した課金形態種別選択肢のラベルで表示する。詳細は 【FIX】商品マスタ（統合版） を参照。 16 商品情報：雇用形態 画面 データベースから取得した商品情報1レコードの「採用課金：雇用形態」を設定ファイルから取得した採用課金：雇用形態選択肢のラベルで表示する。詳細は 【FIX】商品マスタ（統合版） を参照。 17 商品情報：オプション種別 画面 データベースから取得した商品情報1レコードの「オプション種別」を設定ファイルから取得したオプション種別選択肢のラベルで表示する。詳細は 【FIX】商品マスタ（統合版） を参照。 18 商品情報：対象サイト 画面 データベースから取得した商品情報1レコードの「対象サイト」を設定ファイルから取得した対象サイトのラベルで表示する。詳細は 【FIX】商品マスタ（統合版） を参照。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合は全体管理者画面のログイン画面にリダイレクトし、ログイン認証されているが権限の章に記載した権限を持っていない場合は全体管理者画面のTOP画面にリダイレクトする。 「対象サイト」「商品種別」「購入可フラグ」「公開フラグ」の入力処理をおこなう。 入力された全ての条件をAND結合してデータベースから条件に合致したレコードの総件数を取得する。 レコードの総件数が 5,000 を超えていた場合、 5,000件を超えるレコードは無視し、 以降は総件数を 5,000 件として処理を続行する。 レコードの総件数からページ総数を計算し、「ページ番号」の入力がページ総数を超えていた場合、自然数以外を表す文字列だった場合は以降はページ番号=1として処理をおこなう。 レコードの総件数が0件だった場合、データの抽出を実行しないで 0件の商品データ配列を生成する 。 レコードの総件数が1件以上だった場合、上記の条件をもとにして登録日時の降順に並べて、指定されたページ番号に表示すべき商品情報50件のデータをデータベースから抽出する。 出力の章に記載した出力項目をページ表示できるよう整形し、ページを出力する。 4.5. エラー処理 入力処理でエラーは発生させない。 それ以外で発生した例外に関してはフレームワークの例外処理に任せる。 4.6. ログ 一覧を表示した場合に下記フォーマットでログを出力する User {全体管理者のユーザー番号} read service list. page={ページ番号} site={対象サイト} type={商品種別} is_available={購入可フラグ} is_opened={公開フラグ} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 公開/非公開処理を実行した場合に、1レコードごとに、下記フォーマットでログを出力する User {全体管理者のユーザー番号} managed to access on service open. service_number={商品番号} service_id={商品ID} is_opened={True/False} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. スコープ外 ・制限事項 最後に閲覧していた https://giginc.atlassian.net/wiki/pages/resumedraft.action?draftId=713752732 の ページに戻るための機能 はアプリケーションでは提供しない。",
  "parentId": "704676285",
  "parentTitle": "100_【FIX】商品管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/713752732/101_+FIX",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2023-07-24T08:44:40.283Z",
  "author": "ejiri_yusuke",
  "excerpt": "1. 目次 2. 概要 本機能は 【FIX】商品マスタ（統合版） の登録済みのデータの一覧を閲覧するための機能です。 3. 要求事項 全体管理画面にログインすることができる システム管理者、塾ステーション管理者 のみが、登録されている 【FIX】商品マスタ（統合版） 一覧で閲覧することができる。 一覧ページ上部には、下記を表示する。 一覧フィルター用コンポーネント 表示可能なレコードの総数 新規登..."
}