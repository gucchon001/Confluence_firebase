{
  "id": "704577869",
  "title": "265_【FIX】Amazonギフト券管理-CSVアップロード機能",
  "content": "1. 目次 2. 概要 本機能は CSV をアップロードすることで 【FIX】Amazonギフト券情報 を登録するための機能です。 3. 要求事項 管理画面にログインすることができるシステム管理者、塾講師ステーション管理者、ゲスト管理者、ギフト券担当者のみが本機能を利用できる。 261_【FIX】Amazonギフト券管理-一覧閲覧機能 で「ファイル選択」ボタンを押下することで、アップロードするCSVファイルを選択することができる。 261_【FIX】Amazonギフト券管理-一覧閲覧機能 で「CSVアップロード」ボタンを押下した際に、「CSVをアップロードしますか？」というモーダルを表示する。OKが選択された場合はファイル形式のチェックを行う。キャンセルが選択された場合は処理を終了する。 ファイル 形式をチェックし、CSVファイル以外の場合は、「CSV形式のファイルをアップロードしてください」とエラーメッセージを表示し、処理は行わない。 ファイル自体は S3 に保存し、自動的に 1日後 1ヶ月後 削除する。 ファイル形式に問題ない場合は、 以下の規則に従い データベースにデータを保存する。 CSVの データフォーマット は以下の 通り とする。 1行目タイトル、2行目3行目は選択肢の説明、4行目はヘッダ行とし項目名とする。 5行目からAmazonギフト券データを記入する。 存在しないデータはNULLとしてデータベースに登録する。 CSVの文字コードはUTF-8とする。 CSVファイルの各項目は、セル内に改行を入れられるようにするために、ダブルクォーテーションで囲み、中の文字列はダブルクォーテーションエスケープを行うものとする。 CSVのデータ優先順位は以下の通り 必須フィールドは金額、メールアドレス、姓、名、 利用部署、発行理由 。 利用部署と発行理由は入力したい項目に対応するIDの入力形式とする。 任意フィールドは会員番号、姓(カタカナ)、名(カタカナ)、備考。 上記以外のフィールドは、フィールドの有無に関わらず読み込まれない。 会員番号をフィールドに含めた場合、自動でメールアドレス、姓、名、姓(カタカナ)、名(カタカナ)を取得する。 そのため最小の列構成は、金額、会員番号、利用部署、発行理由になる。 会員番号とメールアドレス、氏名、氏名(カタカナ)を同時に指定した場合、CSVで指定したメールアドレス、姓、名、姓(カタカナ)、名(カタカナ) が優先される。 CSVファイルの 最大レコード件数は10,000件とする。 入力内容に問題がある場合は、問題があるCSVの行の値を表示した状態で、どの入力項目に問題があるかわかるようにエラーメッセージを画面上に 表示する 。 エラーなくデータを保存した 場合、「CSVファイルのデータを保存しました」とポップアップを表示し、閉じるボタンを押下するとポップアップを閉じる。 261_【FIX】Amazonギフト券管理-一覧閲覧機能 から「フォーマットをダウンロード」ボタンを押下すると、 次のファイル を ダウンロードできる。 3.1. 権限 3.2. 帳票 3.3. メールテンプレート 3.4. ワークフロー 4. 要件定義 4.1. ユーザーインターフェース（画面） https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=1207-24454&amp;mode=design&amp;t=gNbHtrFxpbBi8yqQ-4 4.3. 入力 4.4. 出力 4.5. 処理 4.6. エラー処理 4.7. ログ アップロード処理を実行した場合に下記フォーマットでログを出力する。 成功した場合 User {全体管理者のユーザー番号} uploaded gift card csv file. gift_card_number={保存されたギフト券番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 失敗した場合 User {全体管理者のユーザー番号} failed to uploaded gift card csv file. {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 各行の登録処理を行った場合は、 262_【FIX】Amazonギフト券管理-新規登録機能 のログを出力する。 5. スコープ外・制限事項",
  "parentId": "704446720",
  "parentTitle": "260_【作成中】Amazonギフト券管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/704577869/265_+FIX+Amazon+-CSV",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2024-05-20T08:52:32.015Z",
  "author": "feng_xiaomeng (Unlicensed)",
  "excerpt": "1. 目次 2. 概要 本機能は CSV をアップロードすることで 【FIX】Amazonギフト券情報 を登録するための機能です。 3. 要求事項 管理画面にログインすることができるシステム管理者、塾講師ステーション管理者、ゲスト管理者、ギフト券担当者のみが本機能を利用できる。 261_【FIX】Amazonギフト券管理-一覧閲覧機能 で「ファイル選択」ボタンを押下することで、アップロードするCS..."
}