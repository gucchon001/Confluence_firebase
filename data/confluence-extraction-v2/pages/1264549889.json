{
  "id": "1264549889",
  "title": "2024-11-06 ミーティング議事録",
  "content": "&nbsp;日付 &nbsp;参加者 トモノカイ：鈴木様( )、池田様( )、片岡様 GIG： 資料 スケジュール タスク管理（Jira） &nbsp;議題 項目 プレゼンター メモ ネクストアクションの確認 16 16 complete 下記を確認する （ ） 17 17 complete オートスケールが反映されるまでにタイムラグがあるか。 18 18 complete アクセス影響が出る前に完了させることは可能か。 19 19 complete ギフト券誤発行に関するAmazon社とのメールを転送する。 20 20 complete Jira、Confluenceの片岡さんアカウント作成する。 &rarr;11/6招待送信済 21 21 incomplete 工数管理シートの最新化と今後の最適な工数配分の検討 22 22 complete 10月分の最新化は実施いたしました 23 23 incomplete 最適な工数配分については検討中になります 24 24 incomplete CTJ-4510 0f376871-0459-35fc-b139-2a34c915ec22 System Jira の調査 25 25 incomplete 原因究明のために、引き続きDEV環境での再現を行い調査中になります。 進捗確認 dev環境で弊社確認中のチケット：工数管理表で緑色の背景になっているチケット 今週木曜日に反映予定のチケット CTJ-4373 0f376871-0459-35fc-b139-2a34c915ec22 System Jira そのほか アクセス障害への対応について 確認できていること 【原因】 特定画面でのSQLが発行された時にDB負荷が高まってしまうことで応答が非常に遅くなってしまいことでタイムアウトしてしまう。 採用画面の「不一致」を抽出クエリ 該当種別：アドミン/クライアント 該当画面：採用確認一覧ページを開くとき オファー画面のユーザー検索クエリ 該当種別：アドミン/クライアント 該当画面：パーソナルオファーの作成画面で検索条件絞り込んだとき DBのCPU負荷が80%を超えたタイミングからオートスケーリングの処理が実行されるが、インスタンス構築に5分程時間がかかるため一時的に接続できない状況が発生してしまう。 【今後の調査の流れ】 主な原因となっている2つのSQLは特定できているため軽量なクエリに改良を実施中。 【これまで発生していなかった理由】 これまでも同様のクエリは存在しており発行されていたが、DBリソースに余裕があった（2台構成）であったために顕著に発生していなかった。 【その他】 接続できない状態が発生しないようにオートスケーリングの設定ができないか 回答：こちら実現が難しいです。 理由：現状平常時はCPU利用率が60%前後を推移するようにインスタンスのスペックを選択しているが、該当クエリが発行された時は急激にCPU利用率が高騰してしまうため検知タイミングからインスタンス構築にどうしても時間がかかってしまう現状がございます。 -&gt;別途調査教室コピーのところが動作重いことの調査（小竹） 対象クエリ① select `user_applications`.`id`, `user_applications`.`user_id`, `user_applications`.`confirmed_flag`, `user_applications`.`recruited_classroom`, `user_applications`.`adoption_status_company`, DATE_FORMAT(user_applications.training_first_day, '%Y/%m/%d') as training_first_day, `user_applications`.`additional_reason`, `user_applications`.`billing_confirmed_at`, `user_applications`.`confirm_enrollment`, `user_applications`.`submission_deadline`, `user_applications`.`submission_status`, `user_applications`.`memo`, `user_applications`.`admin_memo`, `user_applications`.`updated_by`, `user_applications`.`created_at`, `user_applications`.`last_submission_datetime`, `user_applications`.`overdateline_count`, `user_applications`.`pending_count`, `user_applications`.`applied_user_information`, `user_applications`.`applied_job_information`, `user_applications`.`performance_reward_id`, `applied_cbi`.`company_id`, `applied_cbi`.`brand_id`, `applied_cbi`.`plan`, `applied_cbi`.`id` as `classroom_id`, `applied_cbi`.`name` as `classroom_name`, `applied_cbi`.`site` as `applied_cbi_site`, `jbi`.`employment_status`, `recruited_cbi`.`name` as `recruited_classroom_name`, `recruited_cbi`.`company_id` as `recruited_classroom_company_id`, `recruited_cbi`.`site` as `recruited_cbi_site`, `s`.`fixed_time`, (SELECT gsa.answer-&gt;&gt;'$.&quot;3&quot;' FROM gift_survey_answers as gsa WHERE gsa.gift_request_id = gr.id AND gsa.question_id = 3 LIMIT 1) as training_start_date, (SELECT DATE_ADD(training_start_date, INTERVAL 1 MONTH)) AS next_month_date, (SELECT count( gr.id )FROM gift_requests as gr WHERE gr.application_id = user_applications.id AND gr.confirm_status = 1 AND gr.survey_type = 1 AND ( ( not ( user_applications.adoption_status_company = 2 and (user_applications.confirm_enrollment = 1 OR user_applications.confirm_enrollment is null) ) and not ( user_applications.adoption_status_company = 1 and (SELECT gsa.answer-&gt;&gt;'$.&quot;3&quot;' FROM gift_survey_answers as gsa WHERE gsa.gift_request_id = gr.id AND gsa.question_id = 3 LIMIT 1) &gt;= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) ) ) or ( user_applications.submission_status = 1 and user_applications.adoption_status_company = 2 and user_applications.confirm_enrollment is null and ( ( user_applications.training_first_day is not null and DATE_FORMAT(user_applications.training_first_day, '%Y/%m') &gt;= DATE_FORMAT(DATE_ADD((SELECT gsa.answer-&gt;&gt;'$.&quot;3&quot;' FROM gift_survey_answers as gsa WHERE gsa.gift_request_id = gr.id AND gsa.question_id = 3 LIMIT 1) , INTERVAL 1 MONTH), '%Y/%m') ) or ( user_applications.training_first_day is null and DATE_FORMAT((SELECT gsa.answer-&gt;&gt;'$.&quot;3&quot;' FROM gift_survey_answers as gsa WHERE gsa.gift_request_id = gr.id AND gsa.question_id = 3 LIMIT 1) , '%Y/%m') &lt;= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), '%Y/%m') ) ) ) or ( user_applications.submission_status = 2 and user_applications.adoption_status_company = 2 and ( ( user_applications.training_first_day is not null and DATE_FORMAT(user_applications.training_first_day, '%Y/%m') &gt;= DATE_FORMAT(DATE_ADD((SELECT gsa.answer-&gt;&gt;'$.&quot;3&quot;' FROM gift_survey_answers as gsa WHERE gsa.gift_request_id = gr.id AND gsa.question_id = 3 LIMIT 1) , I 対象クエリ② select distinct `um_user_profiles`.`id`, `um_user_profiles`.`user_id`, `um_user_profiles`.`gender`, `um_user_profiles`.`birth_date`, `um_user_profiles`.`current_occupation`, `um_user_profiles`.`prefecture`, `um_user_profiles`.`city`, `uueb`.`humanities_and_sciences`, `uueb`.`school_name`, `uue`.`member_id` from `um_user_profiles` inner join `um_user_emails` as `uue` on `uue`.`user_id` = `um_user_profiles`.`user_id` and `uue`.`verified_at` is not null and `uue`.`deleted_at` is null inner join `um_users` on `um_users`.`id` = `um_user_profiles`.`user_id` and `um_users`.`withdrawn_at` is null and `um_users`.`deleted_at` is null left join `um_user_educational_backgrounds` as `uueb` on `um_user_profiles`.`user_id` = `uueb`.`user_id` and `uueb`.`school_type` = 2 and `uueb`.`deleted_at` is null left join `um_user_educational_backgrounds` as `uueb3` on `um_user_profiles`.`user_id` = `uueb3`.`user_id` and `uueb3`.`school_type` = 3 and `uueb3`.`deleted_at` is null left join `um_user_educational_backgrounds` as `uueb4` on `um_user_profiles`.`user_id` = `uueb4`.`user_id` and `uueb4`.`school_type` = 4 and `uueb4`.`deleted_at` is null left join `user_subjects` as `us` on `um_user_profiles`.`user_id` = `us`.`user_id` left join `user_teaching_experiences` as `ute` on `um_user_profiles`.`user_id` = `ute`.`user_id` left join `user_work_conditions` as `uwc` on `um_user_profiles`.`user_id` = `uwc`.`user_id` left join `user_job_bookmarks` as `ujb` on `um_user_profiles`.`user_id` = `ujb`.`user_id` left join `user_job_view_logs` as `ujv` on `um_user_profiles`.`user_id` = `ujv`.`user_id` where `um_user_profiles`.`prefecture` = 23 and `um_user_profiles`.`city` in ('23104', '23215', '23220', '23233', '23234') and `um_user_profiles`.`birth_date` &lt;= '2006-10-29' and `um_user_profiles`.`birth_date` &gt;= '2002-10-29' and `um_user_profiles`.`current_occupation` in ('2') and `um_user_profiles`.`user_id` not in (select `o`.`user_id` from `offers` as `o` where `o`.`created_at` &gt;= '2024/07/31' and `o`.`company_id` = 1939 and `o`.`offer_type` = 2 group by `o`.`user_id`) and `um_user_profiles`.`user_id` not in (select `uup`.`user_id` from `um_user_profiles` as `uup` inner join `user_applications` as `ua` on `ua`.`user_id` = `uup`.`user_id` inner join `job_basic_informations` as `jbi` on `jbi`.`id` = `ua`.`job_id` inner join `classroom_basic_informations` as `cbi` on `cbi`.`id` = `jbi`.`classroom_id` where `cbi`.`company_id` = 1939 group by `uup`.`user_id`) and `um_user_profiles`.`user_id` in (select `uus`.`user_id` from `um_user_settings` as `uus` where `uus`.`scout_use_flag` = 1 group by `uus`.`user_id`) and `um_user_profiles`.`user_id` not in (select `ubc`.`user_id` from `user_ban_companies` as `ubc` where `ubc`.`company_id` = 1939 group by `ubc`.`user_id`) and `um_user_profiles`.`deleted_at` is null order by `um_user_profiles`.`id` desc limit 50 offset 0 CTJ-4150 0f376871-0459-35fc-b139-2a34c915ec22 System Jira について（GIG小竹） 来週月曜日（11/11）に対応いたします 口コミの課題について共有いたします（トモノカイ池田） 鈴木が調査した資料を共有いたします。問題のある箇所について、仮説を共有いたしますが、詳細については御社に調査いただく形になると思います。 https://docs.google.com/spreadsheets/d/144aPRkICDnX_x7SNhrG28CHVTn4h4MgaMJZqswVzXJo/edit?gid=1274506603#gid=1274506603 4つの課題に分けて起票して優先度順に対応する（小竹） 急募機能の公開に向けた現在の進捗状況について（トモノカイ池田） 社内の連携もちゃんと時間が取れておらず、現在公開に向けて何が完了すればできるようになるのか、認識の擦りり合わせをさせてください。 片岡）すみませんこれがGIG様ボールではなく私ボールで検証進めてます。営業には共有していたのですが、下記工程になっています。 https://docs.google.com/spreadsheets/d/14ySerjaVVdWUPMd2OoS1LlcvlQAutnhAJP9HgbxPFx4/edit?gid=500199006#gid=500199006 今週金曜に工数管理シートの優先順位を見直す（池田さん） &nbsp;アクション事項 口コミについて、4つの課題に分けて起票して優先度順に対応する（池田さん） -&gt;別途調査教室コピーのところが動作重いことの調査（小竹） 重いクエリのチケットに追記 今週金曜に工数管理シートの優先順位を見直す（池田さん） &nbsp;決定事項 「/decision」と入力してこのミーティングで決定した内容を記録します。: b9455583-fc11-4f6e-a694-f0f5e364eda8 7113baef-b9fe-4a11-a28f-9518f6a1b72a DECIDED",
  "parentId": "1235976240",
  "parentTitle": "議事録_2024年",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/1264549889/2024-11-06",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2024-11-12T00:52:12.475Z",
  "author": "kotake_jin",
  "excerpt": "&nbsp;日付 &nbsp;参加者 トモノカイ：鈴木様( )、池田様( )、片岡様 GIG： 資料 スケジュール タスク管理（Jira） &nbsp;議題 項目 プレゼンター メモ ネクストアクションの確認 16 16 complete 下記を確認する （ ） 17 17 complete オートスケールが反映されるまでにタイムラグがあるか。 18 18 complete アクセス影響が出る前に..."
}