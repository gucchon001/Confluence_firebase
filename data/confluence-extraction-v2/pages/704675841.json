{
  "id": "704675841",
  "title": "053_【FIX】スカウト・マッチ利用設定機能",
  "content": "目次 概要 本機能は、会員が自身のオファー機能の利用や受信元企業の情報を編集するための機能です。 要求事項 サービスサイトにログインしている会員が本機能を利用することができる。 概要に記載の帳票1件の登録済み情報を閲覧し、本ページの「要件定義」-「入力」欄で入力元が「入力フォーム」と定義されている項目を編集することができる。 本ページではオファー非公開企業の追加・削除をスムーズ行えるよう、更新ボタンはなく、各追加・削除・変更ボタンを押下するとすぐに、入力内容にエラーがあれば更新はせずにエラーの内容を表示し、エラーがなければそのまま編集した入力フォームの内容をデータベースに保存し、システム全体に適用する、編集完了時にはトーストを表示する。 画面上には以下の項目を表示する 本ページの「要件定義」-「入力」欄で入力元が「入力フォーム」と定義されている項目の、保存された項目値が反映された入力フォーム 本ページの「要件定義」-「出力」欄で出力先として「画面」が定義されている項目の名称と保存された項目値 各種設定ページに戻るボタン 押下すると 055_【FIX】各種設定 に遷移する。 オファー非公開企業の検索 バーにて非公開にしたいテキストを入力し 検索を 押下すると、 121-2_【FIX】企業検索API を利用しそのテキストで部分一致する 検索結果が表示される 。 ただし表示する最大数は10件とし、11件以上の場合は検索結果の上に「 ※検索結果は10件までしか表示できません、対象企業が見当たらない場合はより絞り込んだテキストで検索してください。 」とエラーメッセージを表示する。 検索結果の各企業の「非公開にする」ボタンを押下すると、 【FIX】会員：設定情報（オファー拒否企業） を 1件追加 し 、トーストを表示する。 ただし、すでに 【FIX】会員：設定情報（オファー拒否企業） が30件ある場合は、「※非公開設定できる企業の最大数に達しました。」とエラーメッセージを表示する。 非公開設定にしている企業一覧の各企業の「非公開設定から削除」ボタンを押下すると、ユーザー番号と該当の企業番号による 【FIX】会員：設定情報（オファー拒否企業） を1件削除し、トーストを表示する。 マッチ利用の設定値を利用するに変更した場合は、 056_【FIX】通知設定機能 のメール受信フラグ：マッチ通知メール受信設定の設定を利用するに自動で変更する マッチ利用の設定値を利用しないに変更した場合は、 056_【FIX】通知設定機能 のメール受信フラグ：マッチ通知メール受信設定の設定を利用しないに自動で変更する マッチ利用を利用しないの場合は、メール受信フラグ：マッチ通知メール受信の設定をONにできないようにする スカウト利用の設定値を利用するに変更した場合は、 056_【FIX】通知設定機能 のメール受信フラグ：スカウト通知メール受信設定の設定を利用するに自動で変更する スカウト利用の設定値を利用しないに変更した場合は、 056_【FIX】通知設定機能 のメール受信フラグ：スカウト通知メール受信設定の設定を利用しないに自動で変更する スカウト利用を利用しないの場合は、メール受信フラグ：スカウト通知メール受信の設定をONにできないようにする 権限 要求事項に記載の通り。 帳票 【FIX】会員：設定情報（オファー・メール） 【FIX】会員：設定情報（オファー拒否企業） メールテンプレート なし ワークフロー なし 要件定義 ユーザーインターフェース（画面） 設定変更画面 https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=29645-46491&amp;mode=design&amp;t=v2r5a85pXYcjBDqc-4 変更完了ポップアップ https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=32140-44733&amp;mode=design&amp;t=v2r5a85pXYcjBDqc-4 入力 変数名、説明、バリデーションは、各帳票の記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 変数名 入力元 説明 バリデーション ユーザー番号 Cookie ログインしているユーザーを割り出す スカウト利用 入力フォーム 初期値：データベースから読み込んだ値 必須 マッチ利用 入力フォーム 初期値：データベースから読み込んだ値 必須 オファー非公開にしたい企業名 入力フォーム 初期値なし オファー非公開にしたい企業の企業番号 隠しフォーム 検索結果で表示された各企業について「追加」ボタンを押下すると、その企業番号で 【FIX】会員：設定情報（オファー拒否企業） を追加する。 実際に存在する 【FIX】企業：基本情報 であること。 オファー非公開から削除したい企業の企業番号 隠しフォーム 表示された各企業について「削除」ボタンを押下すると、その企業番号で 【FIX】会員：設定情報（オファー拒否企業） を削除する。 実際に存在する 【FIX】企業：基本情報 であること。 出力 変数名、説明、バリデーションは、各帳票の記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 出力先 説明 1 スカウト利用 データベース/画面 画面の対象フォーム内に保存された値が指し示す選択肢のラベルを出力する。入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 2 マッチ利用 データベース/画面 画面の対象フォーム内に保存された値が指し示す選択肢のラベルを出力する。入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 3 オファー非公開にしたい企業名 画面 画面の対象フォーム内にHTMLエスケープ処理して出力する。 4 検索結果情報配列 画面 指定されたフィルタリングを適用してデータベースから抽出した検索結果情報レコードの配列をテーブル組みでページ上に表示する。各レコードの表示データは以下「検索結果：」プレフィックスで始まる出力項目として説明する。 5 検索結果：企業名 画面 画面の対象フォーム内にHTMLエスケープ処理をして出力する。 6 非公開設定企業情報配列 画面 指定されたフィルタリングを適用してデータベースから抽出した非公開設定企業情報レコードの配列をテーブル組みでページ上に表示する。各レコードの表示データは以下「非公開設定企業：」プレフィックスで始まる出力項目として説明する。 7 非公開設定企業：企業名 画面 画面の対象フォーム内にHTMLエスケープ処理をして出力する。 処理 ログイン状態を確認し、ログイン認証されていない場合はログイン画面にリダイレクトする。 ログインしているユーザー番号を取得し、入力がない場合/自然数ではない場合はレスポンスステータス404 not foundを出力して処理を終了する。 ログインしているユーザー番号でデータベースから該当するレコードを抽出する。 該当するレコードがデータベース上に存在しない場合はレスポンスステータス404 not foundを出力して処理を終了する。 4.4.1. 編集フォーム画面表示処理 該当するレコードが見つかったら、「出力」に記載の通り、表示項目と入力可能項目に項目値を反映させて画面を出力し処理を終了する。 4.4.2. 編集処理 該当するレコードが見つかったら、「入力」に記載の入力項目値の妥当性検査を行う。 入力項目値の妥当性に問題があった場合は、どの項目にどのような問題が発生したかわかるようにエラーメッセージを表示し、入力された値を入力フォーム内に表示・選択された状態で編集フォーム画面を出力して処理を終了する。 入力項目値の妥当性に問題がない場合は、入力された項目値と、更新日時を操作している現在時刻とし、操作を行なっているユーザー番号を更新者に設定した上でデータベースの該当レコードを更新する。 該当のレコードの保存した情報を閲覧できる 055_【FIX】各種設定 へリダイレクトし処理を終了する。 4.5. エラー処理 上記以外で発生したエラー/例外に関してはフレームワークの例外処理に任せる。 4.6. ログ 編集処理を実行した場合に下記フォーマットでログを出力する 成功の場合 User {ユーザー番号} updated offer settings . {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 失敗の場合 User {全体管理者のユーザー番号} failed to update offer settings. {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. スコープ外・制限事項 同時編集に対する明示的な対策は施さない。 同時に編集が実行された際は後勝ちとし、後から保存ボタンを押して実行した時の編集値が適用される。 編集画面において他のウィンドウ・タブが本機能にアクセスしたことをアプリケーションは検知しない。",
  "parentId": "704577558",
  "parentTitle": "050_■マイページ各種管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/704675841/053_+FIX",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2025-08-27T02:28:33.070Z",
  "author": "kotake_jin",
  "excerpt": "目次 概要 本機能は、会員が自身のオファー機能の利用や受信元企業の情報を編集するための機能です。 要求事項 サービスサイトにログインしている会員が本機能を利用することができる。 概要に記載の帳票1件の登録済み情報を閲覧し、本ページの「要件定義」-「入力」欄で入力元が「入力フォーム」と定義されている項目を編集することができる。 本ページではオファー非公開企業の追加・削除をスムーズ行えるよう、更新ボタ..."
}