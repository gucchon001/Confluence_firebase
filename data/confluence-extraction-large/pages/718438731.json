{
  "id": "718438731",
  "title": "302_【機能不要のため削除】請求書PDF詳細閲覧機能",
  "content": "1. 目次 1 6 false list false 2. 概要 本機能は 【FIX】請求：請求書PDF および 【FIX】請求：基本情報 の登録済みのデータ1件を閲覧するための機能です。 3. 要求事項 管理画面にログインできるシステム管理者、塾講師ステーション管理者のみが、概要で挙げた帳票に登録されたデータを一覧で閲覧することができる。 本機能は 【FIX】請求：請求書PDF および 【FIX】請求：基本情報 に記載の項目について、1URL=1レコードで保存された値を表示して閲覧することができる。以下「本ページ」と記載する。 本ページには、以下を表示する 本ページの 「要件定義」-「出力」欄で出力先として「画面」 が定義されている項目 請求書PDF一覧に戻るボタン 押下することで 301-2_【機能不要のため削除】全請求書PDF一覧閲覧機能 に遷移することができる。 請求情報を確認ボタン 押下することで 273_【作成中】請求詳細閲覧機能 に遷移することができる。 検索項目の編集ボタン 存在しない請求書PDFが指定された場合は対象URLのページが存在しないように振る舞う。 詳細ページを閲覧した場合、以下の情報が入ったログを出力する。 日時、管理者ID( 【FIX】全体管理者登録情報 のユーザー番号)、請求書PDF番号( 【FIX】請求：請求書PDF の請求書PDF番号)、アクセス元IPアドレス、ユーザーエージェント 3.1. 権限 管理画面にログインできるシステム管理者、塾講師ステーション管理者のみ 3.2. 帳票 【FIX】請求：請求書PDF 【FIX】請求：基本情報 3.3. メールテンプレート なし 3.4. ワークフロー 270_■請求管理機能 の記載と同じ 4. 要件定義 4.1. ユーザーインターフェース（画面） https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=57864-26399&amp;mode=design&amp;t=3Q0lPlAyR8wkjI74-4 4.2. 入力 説明は、帳票の各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 変数名 入力元 説明 制限とエラーメッセージ 請求書PDF番号 &nbsp; URLパラメータ 閲覧する請求書PDFを一意に指定するためのID 入力がない、または、自然数ではない、またはデータベースに存在しない場合 エラーメッセージは出力せずレスポンスステータスを404 not foundとする 4.3. 出力 説明は、帳票の各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 出力項目 出力先 説明 PDFファイル名 画面 【FIX】請求：請求書PDF の「ファイル名」適切にHTMLエスケープ処理をして出力する。 ダウンロードボタンを押下すると 305_【作成中】請求書PDFダウンロード機能 を実行する。 取引先 画面 紐づく 【FIX】請求：基本情報 の 「請求先：企業番号」から割り出す企業名 を適切にHTMLエスケープ処理をして出力する。 取引金額 画面 紐づく 【FIX】請求：基本情報 の請求金額を、文頭に「&yen;」をつけた上で、3桁カンマ区切りにして出力する。例） &yen;1,000,000 請求対象年月 画面 紐づく 【FIX】請求：基本情報 の「請求対象年月」をYYYY年MM月形式の文字列で出力する。 ステータス 画面 【FIX】請求：請求書PDF の「ステータス」に対応するラベル名を表示する。 承認日時（帳票にない、必要か） 画面 YYYY/mm/dd H:i:s形式の文字列で出力する。 発行通知日時（帳票にない？あとこれ何？） 画面 YYYY/mm/dd H:i:s形式の文字列で出力する。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合は全体管理者画面のログイン画面にリダイレクトし、ログイン認証されているが権限の章に記載した権限を持っていない場合は全体管理者画面のTOP画面にリダイレクトする。 URL文字列から入力された請求書PDF番号文字列を取得し、請求書PDF番号文字列が自然数に変換できない場合、レスポンスステータス404 not foundを出力して処理を終了する。 企業番号文字列を元にデータベースから 【FIX】請求：請求書PDF および 【FIX】請求：基本情報 を取得する。対象の請求書PDF番号のデータが存在しない場合、レスポンスステータス404 not foundを出力して処理を終了する。 対象の企業データが存在したら、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/718438731#4.3.-%E5%87%BA%E5%8A%9B の記載の通り、値に適切な変換処理を行ったのちに画面を出力し処理を終了する。 4.5. エラー処理 上記以外で発生した例外に関してはフレームワークの例外処理に任せる。 4.6. ログ 詳細画面を表示した場合に下記フォーマットでログを出力する User {全体管理者のユーザー番号} read invoice_pdf_files detail. invoice_pdf_file_number={請求書PDF番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. 制限事項 最後に閲覧していた 301-2_【機能不要のため削除】全請求書PDF一覧閲覧機能 のページに戻るための機能はアプリケーションでは提供しない。",
  "parentId": "718635198",
  "parentTitle": "300_■請求書PDF管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/718438731/302_+PDF",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2023-12-12T06:03:03.811Z",
  "author": "feng_xiaomeng (Unlicensed)",
  "excerpt": "1. 目次 1 6 false list false 2. 概要 本機能は 【FIX】請求：請求書PDF および 【FIX】請求：基本情報 の登録済みのデータ1件を閲覧するための機能です。 3. 要求事項 管理画面にログインできるシステム管理者、塾講師ステーション管理者のみが、概要で挙げた帳票に登録されたデータを一覧で閲覧することができる。 本機能は 【FIX】請求：請求書PDF および 【FIX..."
}