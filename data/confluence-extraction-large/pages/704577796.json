{
  "id": "704577796",
  "title": "333_【FIX】記事詳細閲覧機能",
  "content": "1. 目次 2. 概要 本機能は記事（ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 【FIX】記事カスタムフィールド値 【FIX】記事画像 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451/_ ）の登録済みのデータ1件の詳細、および記事のバージョン（ 【FIX】記事バージョン ）の一覧を閲覧するための機能です。 3. 要求事項 全体管理画面にログインすることができる全体管理者、塾講師ステーション管理者、ゲスト管理者、記事管理者、記事担当者 のみ が、登録されている記事の詳細およびバージョンの一覧を閲覧することができる。 本機能は、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 （および紐づく 【FIX】記事画像 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451/_ ）に記載の項目について、1URL=1レコードで保存された値を表示して閲覧することができる。以下「本ページ」と記載する。 本ページには、以下を表示する。表示する項目については、基本的にWFを参照し、特記が必要なものだけ記載する。 プレビューボタン 押下すると、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/718373037 にpreviewフラグを付与して新規タブで開く 。 一覧に戻るボタン 押下すると https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/713359414 に遷移する。 改定履歴を見るボタン 押下すると 確認用 に遷移する。 対象記事の公開フラグが「公開」だった場合、「非公開に変更」ボタン、「公開のまま編集」ボタンを表示する。 「非公開に変更」ボタンを押下すると、対象記事の公開フラグが「公開」から「非公開」になる。詳細は https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/723976536 に記載する。 「公開のまま編集」ボタンを押下すると、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704610650 に遷移する。 対象記事の公開フラグが「非公開」だった場合、「編集」ボタン、「削除」ボタン、「公開に変更」ボタンを表示する。 「編集」ボタンを押下すると、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704610650 に遷移する。 「削除」ボタンを押下すると、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/717947278 に遷移する。 「公開に変更」ボタンを押下すると、対象記事の公開フラグが「非公開」から「公開」になる。詳細は https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/723976536 に記載する。 バージョン一覧 最新の 5件 のバージョン情報を一覧で表示する。 詳細ページを閲覧した場合、以下の情報が入ったログを出力する。 日時、全体管理者のユーザー番号、記事番号、アクセス元IPアドレス、ユーザーエージェント 3.1. 権限 要求事項の記載と同じ 3.2. 帳票 概要の記載と同じ 3.3. ワークフロー 3.3.1. 本機能 【FIX】記事登録・公開・非公開・削除フロー 3.3.2. 関連 【FIX】ピックアップ記事選定フロー 4. 要件定義 本ページで特に指定した場合を除き、 共通要件 に従うものとする。 4.1. ユーザーインターフェース（画面） 記事管理パッケージに備わっている入出力項目の内、今回の機能で利用する項目以外は非表示とする。 https://www.figma.com/design/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?node-id=185174-35836&amp;node-type=frame&amp;t=cHtfuiuRya4xV6QT-0 4.2. 入力 説明は、帳票の各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 変数名 入力元 説明 制限とエラーメッセージ 1 記事番号 &nbsp; URLパラメータ 閲覧する記事を一意に指定するための番号 入力がない、または、自然数ではない、またはデータベースに存在しない場合 エラーメッセージは出力せずレスポンスステータスを404 not foundとする 4.3. 出力 説明は、帳票の各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 4.3.1. 記事基本項目 対象帳票： https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639/_ 項目名 出力先 説明 1 記事番号 画面 HTMLエスケープ処理をして出力する。 2 タイトル 画面 HTMLエスケープ処理をして出力する。 3 タイトル画像 画面 画像のサムネイルを出力する。 4 タイトル画像： 代替 altテキスト 画面 HTMLエスケープ処理をして出力する。 5 カテゴリ 画面 保存された値が指し示す選択肢を出力する。 6 抜粋（要約） 画面 HTMLエスケープ処理をして出力する。 7 本文 画面 保存された値をそのまま（HTMLエスケープ処理をせずに）出力する。 8 管理用メモ 画面 HTMLエスケープ処理をして出力する。 9 公開フラグ 画面 保存された値が指し示す選択肢を出力する。 10 公開日時 画面 HTMLエスケープ処理をして出力する。 11 閲覧可能ユーザー 画面 保存された値が指し示す選択肢を出力する。 12 会員限定記事の本文表示領域 画面 保存された値を「[値] px」形式で出力する。 13 検索対象可否 画面 保存された値が指し示す選択肢を出力する。 14 テンプレート 画面 保存された値が指し示す選択肢を出力する。 15 執筆者 画面 保存された値が指し示す 【FIX】全体管理者登録情報 の氏名を出力する。 16 執筆者情報 画面 保存された値が指し示す 【FIX】全体管理者登録情報 のPRを出力する。 4.3.2. 記事画像 対象帳票： 【FIX】記事画像 「画像タイプ」が「サムネイル用」の画像を出力する。 4.3.3. 記事_ピックアップ 対象帳票： https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451/_ 項目名 出力先 説明 1 ピックアップ種別 画面 保存された値が指し示す選択肢を出力する。 2 ピックアップ表示順 画面 HTMLエスケープ処理をして出力する。 4.3.4. 記事カスタムフィールド値 対象帳票： 【FIX】記事カスタムフィールド値 項目の定義は https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1248591874/_ を参照する。 フィールドの数だけレコードを出力する。 項目名 出力先 説明 1 値_テキスト 画面 HTMLエスケープ処理をして出力する。 2 値_数値 画面 保存された値をHTMLエスケープ処理をして、または値が指し示す選択肢を出力する。 3 値_日時 画面 HTMLエスケープ処理をして出力する。 4.3.5. 記事バージョン 対象帳票： 【FIX】記事バージョン 下記のいずれかを満たす（OR条件で満たす）レコードのみ抽出して表示する。 タイトル更新フラグが「true」（更新あり） 要約更新フラグが「true」（更新あり） 本文更新フラグが「true」（更新あり） 項目名 出力先 説明 1 バージョン 画面 HTMLエスケープ処理をして出力する。 2 バージョン管理メモ 画面 HTMLエスケープ処理をして出力する。 3 更新者 画面 保存された値が指し示す 【FIX】全体管理者登録情報 の情報を「[氏名]（[ニックネーム]）」形式で出力する。 4 更新日時 画面 HTMLエスケープ処理をして出力する。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合、または管理者権限でログインしていない場合は全体管理者画面のログイン画面にリダイレクトする。 URL文字列から入力されたID文字列を取得し、ID文字列が自然数に変換できない場合、レスポンスステータス404 not foundを出力して処理を終了する。 ID文字列を元にデータベースから https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 および紐づく 【FIX】記事カスタムフィールド値 【FIX】記事画像 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451/_ 【FIX】記事バージョン 【FIX】全体管理者登録情報 を取得する。対象のIDの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 データが存在しない場合、レスポンスステータス404 not foundを出力して処理を終了する。 対象の記事データが存在したら、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704577796/333_+FIX#4.3.-%E5%87%BA%E5%8A%9B の記載の通り、値に適切な変換処理を行ったのちに画面を出力し処理を終了する。 4.5. エラー処理 4.6. ログ 詳細画面を表示した場合に下記フォーマットでログを出力する User {全体管理者のユーザー番号} read article detail. article _id={記事番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. スコープ外・制限事項",
  "parentId": "703496344",
  "parentTitle": "330_■記事管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/704577796/333_+FIX",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2025-02-17T09:26:41.767Z",
  "author": "ejiri_yusuke",
  "excerpt": "1. 目次 2. 概要 本機能は記事（ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 【FIX】記事カスタムフィールド値 【FIX】記事画像 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451/_ ）の登録済みのデータ1件の..."
}