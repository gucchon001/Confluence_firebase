{
  "id": "744423704",
  "title": "803_【FIX】sitemap.xml生成バッチ",
  "content": "1. 概要 日ごとにsitemap.xmlを作成しS3に配置する。 2. 要求事項 コマンドラインで実行できるものとする。毎日6:00(JST)に自動実行する。 バッチ処理を開始したらバッチ処理を開始した旨のメッセージと現在日時を含むログを出力する。 sitemap.xmlの出力先は以下とする。 s3://prd-juku-public-tmnk-bucket/uploads/sitemaps/ サイトマップファイルはhttps://www.juku.st/{サイトマップファイル名}で表示できるようにする 。 例） https://www.juku.st/ brands-sitemap.xml 1~13の以下のページ単位でファイルの作成処理を行う。 バッチ処理終了時には、バッチ処理が終了した旨のメッセージと終了日時を含んだログを出力する。 必達終了時間は7:00(JST)とし、その1時間以内に上の処理を完了するようにパフォーマンスを確保する。 ファイル名・対象ページ・出力条件の一覧表 ファイル名とサンプルファイル sitemap 対象ページ 出力条件 1 categories-sitemap.xml 情報局記事カテゴリ 以下の条件を満たす記事が1件以上存在するカテゴリを出力する 【記事の条件】 ・公開中 ・検索対象になっている ・対象大学が設定されていない フェーズ4リリース 時にはリリース直前に生成した以下のXMLファイルを固定で配置し、情報局を実装した後はこのバッチ機能でXMLファイルを生成する 2 classroom-career-sitemap.xml キャリアの 教室 詳細 （条件①&rarr;条件②の順に出力する） 以下の条件を満たす教室が出力されます。 ■ 条件① 【企業の条件】 ・契約中 ・キャリアオプション契約中 ・有効なキャリアの基本契約を持っている 【教室の条件】 ・削除されていない ・プランが「キャリア、キャリアライト」のいずれか ・公開中かつ掲載中 ■条件② 【企業の条件】 ・契約中 ・キャリアオプション契約中 ・有効なキャリアの基本契約を持っている 【教室の条件】 ・削除されていない ・プランが「キャリア、キャリアライト」のいずれか ・ 掲載終了から1年以内 3 classroom-sitemap.xml ステーションの 教室 詳細 （条件①&rarr;条件②の順に出力） 以下の条件を満たす教室が出力されます。 ■条件① 【企業の条件】 ・契約中 ・有効なステーションの基本契約を持っている 【教室の条件】 ・削除されていない ・プランが「プレミアム、グレードアップ、スタンダード、ライト」のいずれか ・公開中かつ掲載中 ■条件② 【企業の条件】 ・契約中 ・有効なステーションの基本契約を持っている 【教室の条件】 ・削除されていない ・プランが「プレミアム、グレードアップ、スタンダード、ライト」のいずれか ・ 掲載終了から1年以内 4 brands -career-sitemap.xml キャリアの教室ブランド（求人検索のブランドでの絞り込み） 以下の条件を満たす求人 教室 （ 検索時にステーションかキャリアかの区別はなし ） が1件以上存在するブランドが出力されます。 【企業の条件】 ・契約中 ・有効な基本契約を持っている 【求人の条件】 ・掲載されている ・削除されていない ・キャリアの求人である ・属する教室が削除されておらず公開かつ掲載 5 brands-sitemap.xml ステーションの教室ブランド（求人検索のブランドでの絞り込み） 以下の条件を満たす求人 教室 （検索時にステーションかキャリアかの区別はなし） が1件以上存在するブランドが出力されます。 【企業の条件】 ・有効な基本契約を持っている 【求人の条件】 ・掲載されている ・削除されていない ・ステーションの求人である ・属する教室が削除されておらず公開かつ掲載 6 company-career-sitemap.xml キャリアの企業 以下の条件 を満たす企業が出力されます。 以下の条件を満たす求人が1件以上存在する企業が出力されます。 【企業の条件】 ・削除されていない ・キャリアオプション契約中 ・有効なキャリアの基本契約を持っている 【求人の条件】 ・掲載されている ・削除されていない ・キャリアの求人である ・属する教室が削除されておらず公開かつ掲載 7 company-sitemap.xml ステーションの企業 以下の条件を満たす求人が1件以上存在する企業が出力されます。 【企業の条件】 ・削除されていない ・有効なステーションの契約を持っている 【求人の条件】 ・掲載されている ・削除されていない ・ステーションの求人である ・キャリアの求人である ・属する教室が削除されておらず公開かつ掲載 8 entries-sitemap.xml 情報局記事詳細 以下の条件を満たす記事が出力されます。 【記事の条件】 ・公開中 フェーズ4リリース 時にはリリース直前に生成した以下のXMLファイルを固定で配置し、情報局を実装した後はこのバッチ機能でXMLファイルを生成する 9 reviews-sitemap.xml 口コミ詳細 以下の条件を満たす口コミが出力されます。 【企業の条件】 ・口コミを公開する 【FIX】企業：設定情報（クライアント企業向け） の「Station口コミ表示」がはいである。 【教室の条件】 ・削除されていない ・公開中 【口コミの条件】 ・削除されていない ・ 公開中 10 job-career-sitemap.xml キャリアの求人詳細 以下の条件を満たす求人が出力されます。 【企業の条件】 ・契約中 ・キャリアオプション契約中 ・有効なキャリアの基本契約を持っている 【教室の条件】 ・削除されていない ・プランが「キャリア、キャリアライト」のいずれか ・公開中かつ掲載中 【求人の条件】 ・削除されていない ・掲載中 11 job-sitemap.xml ステーションの求人詳細 以下の条件を満たす求人が出力されます。 【企業の条件】 ・契約中 ・有効なステーションの契約を持っている 【教室の条件】 ・削除されていない ・ プランが「プレミアム、グレードアップ、スタンダード、ライト、スポットバイト 」のいずれか ・公開中かつ掲載中 【求人の条件】 ・削除されていない ・掲載中 12 keywords-sitemap.xml 情報局記事 キーワード 【キーワードの条件】 ・ステータスが有効 上記の条件を満たし、 かつ、以下の条件を満たす記事が1件以上存在するキーワードが出力されます。 【記事の条件】 ・公開中 ・検索対象になっている ・対象大学が設定されていない フェーズ4リリース 時にはリリース直前に生成した以下のXMLファイルを固定で配置し、情報局を実装した後はこのバッチ機能でXMLファイルを生成する 13 qa-sitemap.xml Q&amp;Aコーナー の質問詳細 以下の条件を満たすQAが出力されます。 【QAの条件】 ・公開中 ・紐づく採用お祝い申請が承認済み フェーズ4リリース 時にはリリース直前に生成した以下のXMLファイルを固定で配置し、情報局を実装した後はこのバッチ機能でXMLファイルを生成する 14 feature-sitemap.xml 以下のステーションの特徴ページ https://www.juku.st/feature/em_XXXX https://www.juku.st/feature/gu_XXXX https://www.juku.st/feature/ap_XXXX https://www.juku.st/feature/we_XXXX https://www.juku.st/feature/re_XXXX https://www.juku.st/feature/sh_XXXX https://www.juku.st/feature/fe_XXXX https://www.juku.st/feature/tr_XXXX https://www.juku.st/feature/qu_XXXX https://www.juku.st/feature/di_XXXX ステーションの特徴ページのURLを出力 タグとURLの対応表は こちら を参照 以下の条件を満たす求人が1件以上存在する特徴ページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 ※以下特徴のみサービス種別に応じて選択可否が異なるため記載のページのみ出力 雇用形態(/feature/em_XXXX)：「アルバイト」「業務委託」の特徴ページを出力 指導形態(/feature/gu_XXXX)：「集団指導（10名以上）」「グループ指導（10名以下）」「個別指導」「チューター・担任助手」「教材作成」「事務スタッフ」「試験監督」「家庭教師」「オンライン指導」「その他」の特徴ページを出力 応募資格(/feature/qu_XXXX)：「大学生以上」「経験者限定」「理系限定」「文系限定」「大学生限定」「短大生OK」「専門学校生OK」「留学生OK」の特徴ページを出力 15 feature-career-sitemap.xml 以下のキャリアの特徴ページ https://www.juku.st/ca/feature/em_XXXX https://www.juku.st/ca/feature/gu_XXXX https://www.juku.st/ca/feature/ap_XXXX https://www.juku.st/ca/feature/we_XXXX https://www.juku/st/ca/feature/re_XXXX https://www.juku.st/ca/feature/sh_XXXX https://www.juku.st/ca/feature/fe_XXXX https://www.juku.st/ca/feature/tr_XXXX https://www.juku/st/ca/feature/qu_XXXX https://www.juku.st/ca/feature/di_XXXX キャリアの特徴ページのURLを出力 タグとURLの対応表は こちら を参照 以下の条件を満たす求人が1件以上存在する特徴ページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 ※以下特徴のみサービス種別に応じて選択可否が異なるため記載のページのみ出力 雇用形態(/ca/feature/em_XXXX)：「アルバイト」「業務委託」「派遣」「契約社員」「正社員」の特徴ページを出力 指導形態(/ca/feature/gu_XXXX)：「集団指導（10名以上）」「グループ指導（10名以下）」「個別指導」「チューター・担任助手」「教材作成」「事務スタッフ」「試験監督」「家庭教師」「オンライン指導」「その他」「教室長」「専任講師」「管理職候補」「学校教員」」の特徴ページを出力 応募資格(/ca/feature/qu_XXXX)：「大学生以上」「経験者限定」「理系限定」「文系限定」「大卒以上」「学生不可」「要教育免許」「プロ講師募集」の特徴ページを出力 16 area-sitemap.xml /area/XXXX /area/XXXX/city/XXXX ステーションのエリアページのURLを出力 ※市区町村ページも出力する 以下の条件を満たす求人が1件以上存在するエリアページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 17 area-career-sitemap.xml /ca/area/XXXX /ca/area/XXXX/city/XXXX キャリアのエリアページのURLを出力 ※市区町村ページも出力する 以下の条件を満たす求人が1件以上存在するエリアページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 18 area-city-sitemap.xml /area/XXXX/city/XXXX ステーションの市区町村ページのURLを出力 以下の条件を満たす求人が1件以上存在するエリアページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 19 area-city-career-sitemap.xml /ca/area/XXXX/city/XXXX キャリアの市区町村ページのURLを出力 以下の条件を満たす求人が1件以上存在するエリアページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 20 station-sitemap.xml /area/XXXX/station/XXXX ステーションの駅ページのURLを出力 以下の条件を満たす求人が1件以上存在する駅ページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 21 station-career-sitemap.xml /ca/area/XXXX/station/XXXX キャリアの駅ページのURLを出力 以下の条件を満たす求人が1件以上存在する駅ページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 22 line-sitemap.xml /line/XXXX ステーションの路線ページのURLを出力 以下の条件を満たす求人が1件以上存在する路線ページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 23 line-career-sitemap.xml /ca/line/XXXX キャリアの路線ページのURLを出力 以下の条件を満たす求人が1件以上存在する路線ページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 24 ordinance-designated-city-sitemap.xml https://www.juku.st/area/hokkaido/city/1101,1102,1103,1104,1105,1106,1107,1108,1109,1110 https://www.juku.st/area/miyagi/city/4101,4102,4103,4104,4105 https://www.juku.st/area/niigata/city/15101,15102,15103,15104,15105,15106,15107,15108 https://www.juku.st/area/kyoto/city/26101,26102,26103,26104,26105,26106,26107,26108,26109,26110,26111 https://www.juku.st/area/osaka/city/27102,27103,27104,27106,27107,27108,27109,27111,27113,27114,27115,27116,27117,27118,27119,27120,27121,27122,27123,27124,27125,27126,27127,27128 https://www.juku.st/area/osaka/city/27141,27142,27143,27144,27145,27146,27147 https://www.juku.st/area/hyogo/city/28101,28102,28105,28106,28107,28108,28109,28110,28111 https://www.juku.st/area/saitama/city/11101,11102,11103,11104,11105,11106,11107,11108,11109,11110 https://www.juku.st/area/chiba/city/12101,12102,12103,12104,12105,12106 https://www.juku.st/area/kanagawa/city/14131,14132,14133,14134,14135,14136,14137 https://www.juku.st/area/kanagawa/city/14151,14152,14153 https://www.juku.st/area/kanagawa/city/14101,14102,14103,14104,14105,14106,14107,14108,14109,14110,14111,14112,14113,14114,14115,14116,14117,14118 https://www.juku.st/area/shizuoka/city/22101,22102,22103 https://www.juku.st/area/shizuoka/city/22138,22139,22140 https://www.juku.st/area/aichi/city/23101,23102,23103,23104,23105,23106,23107,23108,23109,23110,23111,23112,23113,23114,23115,23116 https://www.juku.st/area/okayama/city/33101,33102,33103,33104 https://www.juku.st/area/hiroshima/city/34101,34102,34103,34104,34105,34106,34107,34108 https://www.juku.st/area/fukuoka/city/40101,40103,40105,40106,40107,40108,40109 https://www.juku.st/area/fukuoka/city/40131,40132,40133,40134,40135,40136,40137 https://www.juku.st/area/kumamoto/city/43101,43102,43103,43104,43105 各政令指定都市のページのURLを出力 以下の条件を満たす求人が1件以上存在するページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 25 ordinance-designated-city-career-sitemap.xml 22のキャリアのURL キャリアのおける各政令指定都市のページのURLを出力 以下の条件を満たす求人が1件以上存在するページを出力する 【求人の条件】 ・求人が掲載されている ・該当求人が削除されていない ・属する教室が削除されておらず公開かつ掲載 2.1. メールテンプレート 2.2. ワークフロー 3. 要件定義 3.1. 入力 3.2. 出力 3.3. 処理 3.4. エラー処理 下記通知先にエラーログ通知を行う。 【FIX】バッチエラー時通知先 3.5. ログ バッチ略称はgenerate_daily_sitemaps (GDM) とする。 バッジ処理全体が開始した時と終了した時に以下のログを出力する。 開始時 [803_GDM] Started at {処理開始日時}. 成功時 [803_GDM] Succeeded to generate daily sitemap. sitemap_file_name={生成されたファイル名} time={現在時刻}. 失敗時 [803_GDM] Failed to generate daily sitemap. failed_sitemap_file_name={生成に失敗したファイル名} time={現在時刻}. 終了時 [803_GDM] Finished at {処理終了日時}. 4. スコープ外・制限事項 -",
  "parentId": "744718575",
  "parentTitle": "800_■システム内部処理関連バッチ",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/744423704/803_+FIX+sitemap.xml",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2025-07-18T08:08:18.139Z",
  "author": "isamu saito",
  "excerpt": "1. 概要 日ごとにsitemap.xmlを作成しS3に配置する。 2. 要求事項 コマンドラインで実行できるものとする。毎日6:00(JST)に自動実行する。 バッチ処理を開始したらバッチ処理を開始した旨のメッセージと現在日時を含むログを出力する。 sitemap.xmlの出力先は以下とする。 s3://prd-juku-public-tmnk-bucket/uploads/sitemaps/ ..."
}