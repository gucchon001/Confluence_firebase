{
  "id": "714604678",
  "title": "113_【FIX】契約詳細閲覧機能",
  "content": "1. 目次 2. 概要 本機能は 【FIX】契約情報（統合版） の登録済みのデータの1件を閲覧するための機能です。 3. 要求事項 管理画面にログインすることができるシステム管理者、塾ステーション管理者のみが利用することができる。 本機能は 【FIX】契約情報（統合版） に記載の項目について、1URL=1レコードで保存された値を表示して閲覧することができる。以下「本ページ」と記載する。 本ページには、以下を表示する 一覧に戻るボタン 押下することで https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714670163 に遷移することができる。 更新用契約の作成ボタン 押下することで https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714211558 に遷移することができる。 無効にするボタン 押下することで、該当契約を無効にすることができる。 詳細は https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714637410 にて定義する。 メモを保存するボタン 押下することでメモを更新することができる。 詳細は https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714637410 にて定義する。 本ページの「要件定義」-「出力」欄（ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714604678#4.3.-%E5%87%BA%E5%8A%9B ）で出力先として「画面」が定義されている項目 存在しない契約が指定された場合は対象URLのページが存在しないように振る舞う。 3.1. 権限 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714637353 の記載と同じ 3.2. 帳票 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714637353 の記載と同じ 3.3. メールテンプレート なし 3.4. ワークフロー https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714637353 の記載と同じ 4. 要件定義 4.1. ユーザーインターフェース（画面） https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=1888-30160&amp;mode=design&amp;t=88E4Sp4L2FhNeysC-0 4.2. 入力 変数名、説明、バリデーションは、 【FIX】契約情報（統合版） の記載を前提とし、本ページに固有の特記事項のみ記載する。 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714637353 に記載の共通入力・取得項目は項目自体を省略する。 項目名 変数名 入力元 説明 制限とエラーメッセージ 1 契約番号 URLパラメータ 閲覧する契約を一意に指定するための番号 入力がない、または、自然数ではない、またはデータベースに存在しない場合 エラーメッセージは出力せずレスポンスステータスを404 not foundとする 4.3. 出力 説明は、 【FIX】契約情報（統合版） の記載を前提とし、本ページに固有の特記事項のみ記載する。 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714637353 に記載の共通出力項目は項目自体を省略する。 出力項目 出力先 説明 1 契約番号 画面 HTMLエスケープ処理をして出力する。 2 企業 画面 保存された値が指し示す企業を「[企業コード]_[企業名]」形式で出力する。 テキストリンクとして表示 し、押下すると別タブで対象の商品の https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/740163745 ページを開く。 3 教室グループ 画面 保存された値が指し示す教室グループを「[教室グループID_[教室グループ名]」形式で出力する。 テキストリンクとして表示 し、押下すると別タブで対象の商品の https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704741470 ページを開く。 4 商品 画面 保存された値が指し示す商品を「[商品ID]_[対象サイト]_[商品種別]_[単価]」形式で出力する。 テキストリンクとして表示 し、押下すると別タブで対象の商品の https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/717455936 ページを開く。 5 締結日 画面 yyyy年mm月dd日形式の文字列で出力する。 6 有効期間 画面 「yyyy年mm月dd日 hh:mm:ss 〜 yyyy年mm月dd日 hh:mm:ss」形式の文字列で表示する。 7 無効化日時 画面 値が保存されてない場合は、画面上の「ステータス」欄に、「有効」と出力する。 値が保存されている場合は、画面上の「ステータス」欄に、「[有効フラグ]（[無効化日時] [無効化実行者氏名]）」形式で出力する。無効化日時は「yyyy年mm月dd日 hh:mm:ss」形式とする。 8 無効化実行者 画面 値が保存されている場合は、画面上の「ステータス」欄に、「[有効フラグ]（[無効化日時] [無効化実行者氏名]）」形式で出力する。 9 請求先・振込先 画面 保存された値が指し示す請求先・振込先を「[請求先・振込先マスタ番号]_[名称]」形式で出力する。 テキストリンクとして表示 し、押下すると別タブで対象の請求先・振込先が表示される https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/910884866 ページを開く 。 10 無料化フラグ 画面 保存された値が真の場合のみ無料と表示する。 11 親基本契約 画面 「[契約番号]_ [商品：表示名称] _[有効期間：開始日]-[有効期間：終了日]」形式で出力する。有効期間の開始日・終了日は、yyyy/mm/dd-yy/mm/ddとする。 テキストリンクとして表示 し、押下すると別タブで対象の商品の https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714604678 ページを開く。 12 子契約 画面 本レコードを親基本契約として紐づけている他の契約情報を、「[契約番号]_ [商品：表示名称] _[有効期間：開始日]-[有効期間：終了日]」形式で1レコードごとに改行して表示する。有効期間の開始日・終了日は、yyyy/mm/dd-yy/mm/ddとする。 それぞれ、テキストリンクとして表示 し、押下すると別タブで対象の商品の https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714604678 ページを開く。 13 前契約 画面 「[契約番号]_ [商品：表示名称] _[有効期間：開始日]-[有効期間：終了日]」形式で出力する。有効期間の開始日・終了日は、yyyy/mm/dd-yy/mm/ddとする。 テキストリンクとして表示 し、押下すると別タブで対象の商品の https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714604678 ページを開く。 14 次契約 画面 本レコードを前契約として紐づけている他の契約情報を、「[契約番号]_ [商品：表示名称] _[有効期間：開始日]-[有効期間：終了日]」形式で出力する。有効期間の開始日・終了日は、yyyy/mm/dd-yy/mm/ddとする。 テキストリンクとして表示 し、押下すると別タブで対象の商品の https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714604678 ページを開く。 15 更新意向 画面 保存された「更新辞退フラグ」が有効状態の場合のみ「更新しない」と表示する。 基本契約の場合のみ表示し、その他の契約の場合は項目自体を表示しない。 16 担当者 画面 保存された値が指し示す全体管理者氏名を出力する。 17 メモ 画面 入力された改行を維持したまま表示されるようにHTMLエスケープ処理をしてフォーム内に出力する。 メモの編集については https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714637410 にて定義する。 18 作成日時 画面 yyyy-mm-dd hh:mm:ss形式の文字列で出力する。 19 作成者 画面 保存された値が示すユーザーの氏名を表示する。 20 最終更新日時 画面 yyyy-mm-dd hh:mm:ss形式の文字列で出力する。 21 最終更新者 画面 保存された値が示すユーザーの氏名を表示する。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合は全体管理者画面のログイン画面にリダイレクトし、ログイン認証されているが権限の章に記載した権限を持っていない場合は全体管理者画面のTOP画面にリダイレクトする。 URL文字列から入力された契約番号文字列を取得し、契約番号文字列が自然数に変換できない場合、レスポンスステータス404 not foundを出力して処理を終了する。 契約番号文字列を元にデータベースから 【FIX】契約情報（統合版） を取得する。対象の契約番号のデータが存在しない場合、レスポンスステータス404 not foundを出力して処理を終了する。 対象の契約番号のデータが存在したら、本ページの出力欄（ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/714604678#4.3.-%E5%87%BA%E5%8A%9B ）の記載の通り、値に適切な変換処理を行ったのちに画面を出力し処理を終了する。 4.5. エラー処理 上記以外で発生した例外に関してはフレームワークの例外処理に任せる。 4.6. ログ 詳細画面を表示した場合に下記フォーマットでログを出力する User {全体管理者のユーザー番号} read contract detail. contract_number={契約番号} {URI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. スコープ外・制限事項 なし",
  "parentId": "714637353",
  "parentTitle": "110_【FIX】契約管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/714604678/113_+FIX",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2025-02-17T08:01:17.752Z",
  "author": "ejiri_yusuke",
  "excerpt": "1. 目次 2. 概要 本機能は 【FIX】契約情報（統合版） の登録済みのデータの1件を閲覧するための機能です。 3. 要求事項 管理画面にログインすることができるシステム管理者、塾ステーション管理者のみが利用することができる。 本機能は 【FIX】契約情報（統合版） に記載の項目について、1URL=1レコードで保存された値を表示して閲覧することができる。以下「本ページ」と記載する。 本ページに..."
}