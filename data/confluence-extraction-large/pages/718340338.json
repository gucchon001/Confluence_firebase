{
  "id": "718340338",
  "title": "155_【FIX】教室グループ削除機能",
  "content": "1. 目次 2. 概要 本機能は 【FIX】教室グループ の登録済みのデータを削除するための機能です。 また企業削除による影響は 【レビュー中】レコード削除時の動作一覧 にて列挙している。 3. 要求事項 全体管理画面にログインすることができるシステム管理者、塾講師ステーション管理者、ゲスト管理者が本機能を利用することができる。 記事担当者、ギフト券担当者は本機能を利用することはできない。 「削除」ボタンを押下すると、削除実行確認ダイアログを表示し、「キャンセル」か「削除する」を選択できる。 「キャンセル」を押下した場合、対象教室グループを削除せず、確認ダイアログを閉じる。 「削除する」を押下した場合、管理画面の教室グループ一覧・教室グループ詳細ページ及び、サービスサイトの以下ページで対象教室グループを論理削除し、「教室グループを削除しました。」文言が画面上部に表示される。 教室、または有効な契約が紐づけられている場合、削除することはできず、下記の様に、削除ができない旨と理由を示したメッセージを表示する。 「教室が紐づけられているため削除できません」 「有効な契約が紐づけられているため削除できません」 3.1. 権限 150_【FIX】教室グループ管理機能 3.2. 帳票 150_【FIX】教室グループ管理機能 3.3. メールテンプレート 本機能で扱うメールテンプレートページへのリンクです 3.4. ワークフロー 3.4.1. 本機能 本機能の利用シーンを示しているワークフローへのリンクです 3.4.2. 関連 【FIX】教室登録・公開・削除フロー 4. 要件定義 4.1. ユーザーインターフェース（画面） 4.1.1. 削除確認画面 https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=2489-34679&amp;mode=design&amp;t=3sd5fAKslJNrLVF9-4 4.1.2. 削除完了画面 https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=2489-34685&amp;mode=design&amp;t=3sd5fAKslJNrLVF9-4 4.1.3. 削除不可メッセージ画面 https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=10558-64010&amp;mode=design&amp;t=NjxhWWuTHzNsiC94-0 4.2. 入力 変数名、説明、バリデーションは、 【FIX】教室グループ の記載を前提とし、本ページに固有の特記事項のみ記載する。 150_【FIX】教室グループ管理機能 に記載の共通入力・取得項目は項目自体を省略する。 項目名 変数名 入力元 説明 制限とエラーメッセージ 1 教室グループ番号 &nbsp; 入力フォーム 隠しフォーム 削除する対象の教室グループの教室グループ番号を一つのみ入力することができる。 入力がない、または、要素が自然数ではない、または指定番号の教室グループがデータベースに存在しない場合 エラーメッセージは出力せず、正しい番号に対してのみ処理を実行する。 4.3. 出力 説明は、 【FIX】教室グループ の記載を前提とし、本ページに固有の特記事項のみ記載する。 150_【FIX】教室グループ管理機能 に記載の共通入力・取得項目は項目自体を省略する。 出力項目 出力先 説明 1 削除者 データベース 【作成中】帳票共通項目 に従う。 2 削除日時 データベース 【作成中】帳票共通項目 に従う。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合は全体管理者画面のログイン画面にリダイレクトし、ログイン認証されているが権限の章に記載した権限を持っていない場合は全体管理者画面のTOP画面にリダイレクトする。 隠しフォームから取得した教室グループ番号文字列を取得し、教室グループ番号文字列が自然数に変換できない場合、レスポンスステータス404 not foundを出力して処理を終了する。 教室グループ番号文字列を元にデータベースから 【FIX】教室グループ を取得する。対象の教室グループ番号のデータが存在しない場合、レスポンスステータス404 not foundを出力して処理を終了する。 削除対象の教室グループが存在し、現在有効な契約がない、かつ、教室が紐付けされていない場合 削除実行の確認メッセージを表示し、実行用のボタンが押下された場合、対象の教室グループを論理削除し、削除者、削除時間を記録する。キャンセル用のボタンが押下された場合、削除は実施せずに、処理を終了する。 削除が完了したポップアップを表示し、成功ログを出力し、 151_【FIX】教室グループ一覧閲覧機能 ページに遷移する。 現在有効な契約がある、または、教室が紐付けされている場合は、削除できない旨のメッセージを表示して、処理を終了する。 なお削除時の影響範囲については https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/772014210#2.-%E5%89%8A%E9%99%A4%E6%99%82%E3%81%AE%E5%8B%95%E4%BD%9C%E4%B8%80%E8%A6%A7 にてまとめている。 4.5. エラー処理 設定ファイルが存在しない、データベースにテーブル・フィールドが存在しない、メールテンプレートファイルが存在しない場合はプログラム上で特別な処理を行わず、Laravelの例外出力に任せる。 4.6. ログ 削除に成功した場合に下記フォーマットでログを出力する User {全体管理者のユーザー番号} deleted brand . brand _number={教室グループ番号} brand _id={ID} brand _name={教室グループ名} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 削除に失敗した場合に下記フォーマットでログを出力する User {全体管理者のユーザー番号} failed to delete brand . brand _number={教室グループ番号} brand _id={ID} brand _name={教室グループ名} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. スコープ外・制限事項 なし",
  "parentId": "704413785",
  "parentTitle": "150_【FIX】教室グループ管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/718340338/155_+FIX",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2023-08-16T09:15:49.863Z",
  "author": "ejiri_yusuke",
  "excerpt": "1. 目次 2. 概要 本機能は 【FIX】教室グループ の登録済みのデータを削除するための機能です。 また企業削除による影響は 【レビュー中】レコード削除時の動作一覧 にて列挙している。 3. 要求事項 全体管理画面にログインすることができるシステム管理者、塾講師ステーション管理者、ゲスト管理者が本機能を利用することができる。 記事担当者、ギフト券担当者は本機能を利用することはできない。 「削除..."
}