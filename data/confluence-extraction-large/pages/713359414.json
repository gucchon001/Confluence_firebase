{
  "id": "713359414",
  "title": "331_【FIX】記事一覧閲覧機能",
  "content": "1. 目次 2. 概要 本機能は https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 （ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 【FIX】記事カスタムフィールド値 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451/_ ）の登録済みのデータの一覧を閲覧するための機能です。 3. 要求事項 全体管理画面にログインできるシステム管理者、塾講師ステーション管理者、ゲスト管理者、記事管理者、記事担当者のみが、概要で挙げた帳票に登録されたデータを一覧で閲覧することができる。 一覧ページ上部には、下記を表示する。 一覧フィルター用コンポーネント 一覧フィルター用コンポーネントの表示項目はWFにて定義の通りで全てAND結合とし、「絞り込み」ボタンを表示するまでフィルター項目の変更は適用されないものとする。選択式のフィルター項目では、何も選択・入力していない状態を初期値とする。各フィルター項目は基本的にWFを参照し、特筆すべき内容を以下に記載する。 検索ボタン 押下するとフィルター項目での一覧絞り込みを実行する。検索結果が1件もなかった場合は、「検索結果が見つかりません。」と表示する。 新規登録ボタン 押下すると https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704545028 に遷移する。 表示可能なレコードの総数 １ページあたりの表示数を 50件 とし、表示対象のレコードが51件以上の場合は、ページネーションと現在のページ数、総ページ数を一覧の上部と下部に表示する。 更新日時の降順で表示し、並べ替えを行うことはできなくて良い。 一覧の各レコードに表示する項目は基本的にWFを参照し、特筆すべき内容を以下に記載する。 記事タイトル 押下すると https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704577796 へ遷移する。 プレビューボタン 押下すると https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/718373037 にpreviewフラグを付与して新規タブで開く 。 編集ボタン 押下すると https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704610650 へと遷移する。 削除ボタン 押下すると https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/717947278 を実行する。 3.1. 権限 要求事項の記載と同じ 3.2. 帳票 概要 の記載と同じ 3.3. メールテンプレート なし 3.4. ワークフロー 3.4.1. 本機能 【FIX】記事登録・公開・非公開・削除フロー 3.4.2. 関連 【FIX】ピックアップ記事選定フロー 4. 要件定義 本ページで特に指定した場合を除き、 共通要件 に従うものとする。 4.1. ユーザーインターフェース（画面） 記事管理パッケージに備わっている入出力項目の内、今回の機能で利用する項目以外は非表示とする。 https://www.figma.com/design/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?node-id=185174-36130&amp;node-type=frame&amp;t=kUBXpZRwMgUzXNdp-0 4.2. 入力 説明は、帳票の各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 変数名 入力元 説明 制限とエラーメッセージ 1 記事番号 id URLパラメータ／入力フォーム フィルター項目 1行テキストボックスで入力し、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「記事番号」を完全一致でフィルタリングする。 初期状態は最後に入力したものを表示する。前に入力されたものがない場合は空欄を表示する。 任意項目。入力されていない場合はフィルタリングはおこなわない。 2 タイトル title URLパラメータ／入力フォーム フィルター項目 1行テキストボックスで入力し、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「タイトル」を部分一致でフィルタリングする。 最大文字数は30文字、単一入力のみ受け付ける。最大文字数を超えた検索の場合は最初の30文字で検索をかける。 初期状態は最後に入力したものを表示する。前に入力されたものがない場合は空欄を表示する。 3 カテゴリ category_id URLパラメータ／入力フォーム フィルター項目 単一選択のセレクトボックスで入力し、 【FIX】記事カテゴリ に登録されている選択肢と「すべて」から選択することができる。 デフォルトは「すべて」。 【FIX】記事カテゴリ に登録されている選択肢以外が入力された場合は「すべて」と判定し、どんな値が入力されてもエラーは発生させない。 任意項目。入力されていない場合は「すべて」と判定しフィルタリングはおこなわない。 4 ピックアップ種別 pickup_type URLパラメータ／入力フォーム フィルター項目 単一選択のセレクトボックスで入力し、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451 の「ピックアップ種別」に記載されている選択肢と「すべて」から選択することができる。 デフォルトは「すべて」。 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451 の「ピックアップ種別」に記載されている選択肢以外が入力された場合は「すべて」と判定し、どんな値が入力されてもエラーは発生させない。 任意項目。入力されていない場合は「すべて」と判定しフィルタリングはおこなわない。 5 公開フラグ public_flag URLパラメータ／入力フォーム フィルター項目 単一選択のラジオボタンで入力し、 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「公開フラグ」に記載されている選択肢と「すべて」から選択することができる。 デフォルトは「すべて」。 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「公開フラグ」に記載されている選択肢以外が入力された場合は「すべて」と判定し、どんな値が入力されてもエラーは発生させない。 任意項目。入力されていない場合は「すべて」と判定しフィルタリングはおこなわない。 6 ページ番号 page URLパラメータ 一覧のページネーションで表示するページを指定するページ番号。自然数の数字で指定する。 入力がない場合、自然数に変換不可能な文字列が入力された場合、存在しないページ番号が指定された場合はいずれもページ番号を1として処理を行う。 自然数以外が入力された場合は1として処理しエラーは発生させない。 存在しないページ番号が指定された場合は1として処理しエラーは発生させない。 4.3. 出力 出力項目 出力先 説明 1 件数 画面 指定されたフィルタリングを適用した結果表示可能なデータの総件数をページ上部に表示する。 2 総ページ数 画面 指定されたフィルタリングを適用した結果の件数に対して１ページあたり50件の表示で計算した総ページ数をページ上部に表示する。 3 ページ番号 画面 入力されたページ番号を入力処理にて変換した値をページ上部に表示する。 4 記事番号 画面 入力された値を入力処理にて変換した値を、フィルター用コンポーネント内の該当欄に表示する。 5 タイトル 画面 入力された値を入力処理にて変換した値を、フィルター用コンポーネント内の該当欄に表示する。 6 カテゴリ 画面 入力された値を入力処理にて変換した値を利用し、フィルター用コンポーネント内の該当欄で初期選択状態とする。 7 ピックアップ種別 画面 入力された値を入力処理にて変換した値を利用し、フィルター用コンポーネント内の該当欄で初期選択状態とする。 8 記事情報配列 画面 指定されたフィルタリングを適用してデータベースから抽出した記事レコードの配列をテーブル組みでページ上に表示する。各レコードの表示データは以下「記事情報：」プレフィックスで始まる出力項目として説明する。 9 記事情報：記事番号 画面 データベースから取得した記事情報1レコードの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「記事番号」を表示する。 10 記事情報：カテゴリ 画面 データベースから取得した記事情報1レコードの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「カテゴリ」を、選択肢のラベルとして表示する。 11 記事情報：タイトル 画面 データベースから取得した記事情報1レコードの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「タイトル」を表示する。 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704577796 にハイパーリンクする。 12 記事情報：公開状態 画面 データベースから取得した記事情報1レコードの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「公開フラグ」を、選択肢のラベルとして表示する。 13 記事情報：ピックアップ 画面 データベースから取得した記事情報1レコードの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 に紐づく https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451 の値を下記の通り表示する。 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451 レコードが無い場合：空白 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451 が存在する場合： https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/1245544451 の「ピックアップ種別」と「表示順」を、[ピックアップ種別のラベル]（[表示順]）の形式で表示する。 14 記事情報：執筆者 画面 データベースから取得した記事情報1レコードの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「執筆者」の値が示す 【FIX】全体管理者登録情報 の「氏名」を表示する。 15 記事情報：管理用メモ 画面 データベースから取得した記事情報1レコードの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「管理用メモ」を表示する。 16 記事情報：更新日時 画面 データベースから取得した記事情報1レコードの https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 の「更新日時」をyyyy/mm/dd hh:mm形式で表示する。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合は全体管理者画面のログイン画面にリダイレクトし、ログイン認証されているが権限の章に記載した権限を持っていない場合は全体管理者画面のTOP画面にリダイレクトする。 フィルター項目の入力処理をおこなう。 入力された全ての条件をAND結合してデータベースから条件に合致したレコードの総件数を取得する。 レコードの総件数が5,000を超えていた場合、5,000件を超えるレコードは無視し、以降は総件数を5,000件として処理を続行する。 レコードの総件数からページ総数を計算し、「ページ番号」の入力がページ総数を超えていた場合、自然数以外を表す文字列だった場合は以降はページ番号=1として処理をおこなう。 レコードの総件数が0件だった場合、データの抽出を実行しないで0件のデータ配列を生成する。 レコードの総件数が1件以上だった場合、上記の条件をもとにして更新日時の降順に並べて、指定されたページ番号に表示すべき情報50件のデータをデータベースから抽出する。 出力の章に記載した出力項目をページ表示できるよう整形し、ページを出力する。 4.5. エラー処理 4.6. ログ 一覧を表示した場合に下記フォーマットでログを出力する User {全体管理者のユーザー番号} read article list. page={ページ番号} article _id={記事番号} title={タイトル} category_id={カテゴリ} pickup_type={ピックアップ種別} public_flag={公開フラグ} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. スコープ外・制限事項",
  "parentId": "703496344",
  "parentTitle": "330_■記事管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/713359414/331_+FIX",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2024-11-26T05:56:55.421Z",
  "author": "ejiri_yusuke",
  "excerpt": "1. 目次 2. 概要 本機能は https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 （ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/682557639 【FIX】記事カスタムフィールド値 https://giginc.atlassian.ne..."
}