{
  "id": "910884866",
  "title": "473_【FIX】請求先マスタ編集機能",
  "content": "1. 目次 1 6 false list false 2. 概要 本機能は 【作成中】企業：請求先・振込先マスタ の登録済みのデータ1件を編集するための機能です。 3. 要求事項 全体管理画面にログインすることができるシステム管理者、塾講師ステーション管理者のみが本機能を利用することができる。 登録されている 【作成中】企業：請求先・振込先マスタ 1件の登録済み情報を閲覧し、本ページの 「要件定義」-「入力」 欄で入力元が「入力フォーム」と定義されている項目を編集することができる。 画面上には以下の項目を表示する 本ページの 「要件定義」-「入力」欄 で入力元が「入力フォーム」と定義されている項目の、保存された項目値が反映された入力フォーム 本ページの 「要件定義」-「出力」欄 で出力先として「画面」が定義されている項目の名称と保存された項目値 更新するボタン キャンセルボタンボタン キャンセルボタンを押下すると編集を取り消し、 472_【FIX】請求先マスタ一覧閲覧機能 に遷移する。 更新するボタンを押下すると、入力内容にエラーがあれば更新はせずにエラーの内容を表示する。エラーがなければそのまま編集した入力フォームの内容をデータベースに保存し、システム全体に適用し、編集完了のポップアップを表示する。 編集完了のポップアップには閉じるボタンを配置し、押下すると 472_【FIX】請求先マスタ一覧閲覧機能 に遷移する。 3.1. 権限 要求に記載の通り。 3.2. 帳票 概要に記載の通り。 3.3. メールテンプレート なし 3.4. ワークフロー なし 4. 要件定義 4.1. ユーザーインターフェース（画面） 4.1.1. 請求先マスタ編集画面 https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=90649-53473&amp;mode=design&amp;t=RtX5Kz78tSMbtcmp-0 4.1.2. 編集完了画面 https://www.figma.com/file/8zITZViFoU0WYNnwig5AKc/%E3%80%90%E5%85%B1%E6%9C%89%E3%80%91%E3%83%88%E3%83%A2%E3%83%8E%E3%82%AB%E3%82%A4%E6%A7%98_%E5%A1%BE?type=design&amp;node-id=90649-53249&amp;mode=design&amp;t=RtX5Kz78tSMbtcmp-0 4.2. 入力 説明は、帳票の各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 変数名 入力元 説明 バリデーション 請求先・振込先マスタ番号 隠しフォーム 編集する対象を一意に指定する。 入力がない、または、自然数ではない、または指定IDのレコードがデータベースに存在しない場合 エラーメッセージは出力せずレスポンスステータスを404 not foundとする 名称 入力フォーム 初期状態：データベースから読み込んだ値 必須 FM請求集計ID 入力フォーム 初期状態：データベースから読み込んだ値 必須 支払いサイト 入力フォーム 初期状態：データベースから読み込んだ値 必須 回収サイクル 入力フォーム 初期値＝▼選択してください 必須 入金締日 入力フォーム 初期値なし 必須 請求締日 入力フォーム 初期値なし 必須 手数料 入力フォーム 初期値なし 必須 請求先：郵便番号 入力フォーム 初期状態：データベースから読み込んだ値 必須 請求先：都道府県 入力フォーム 初期状態：データベースから読み込んだ値 必須 請求先：市区町村 入力フォーム 初期状態：データベースから読み込んだ値 必須 請求先：以降の住所 入力フォーム 初期状態：データベースから読み込んだ値 必須 請求先：企業名 入力フォーム 初期状態：データベースから読み込んだ値 必須 請求先：担当部署 入力フォーム 初期状態：データベースから読み込んだ値 請求先：担当者名 入力フォーム 初期状態：データベースから読み込んだ値 必須 振込先：金融機関番号 入力フォーム 初期状態：データベースから読み込んだ値 振込先：金融機関名 入力フォーム 初期状態：データベースから読み込んだ値 必須 振込先：支店番号 入力フォーム 初期状態：データベースから読み込んだ値 振込先：支店名 入力フォーム 初期状態：データベースから読み込んだ値 必須 振込先：口座種別 入力フォーム 初期状態：データベースから読み込んだ値 必須 振込先：口座番号 入力フォーム 初期状態：データベースから読み込んだ値 必須 4.3. 出力 説明は、帳票の各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 出力先 説明 1 請求先・振込先マスタ番号 画面 保存されたデータをテキストで表示する。 2 名称 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 3 FM請求集計ID データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 4 支払いサイト データベース/画面 画面の対象フォーム内に保存された値が指し示す選択肢のラベルを全て出力する。入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 5 回収サイクル データベース/画面 入力妥当性検査によるエラー発生時は画面の対象フォーム内に、入力された値が指し示す選択肢が選択された状態で表示する。エラーがない場合は入力された値にSQLインジェクション対策をしてデータベースに保存する。 6 入金締日 データベース/画面 入力妥当性検査によるエラー発生時は画面の対象フォーム内に、入力された値が指し示す選択肢が選択された状態で表示する。エラーがない場合は入力された値にSQLインジェクション対策をしてデータベースに保存する。 7 請求締日 データベース/画面 入力妥当性検査によるエラー発生時は画面の対象フォーム内に、入力された値が指し示す選択肢が選択された状態で表示する。エラーがない場合は入力された値にSQLインジェクション対策をしてデータベースに保存する。 8 手数料 データベース/画面 入力妥当性検査によるエラー発生時は画面の対象フォーム内に、入力された値が指し示す選択肢が選択された状態で表示する。エラーがない場合は入力された値にSQLインジェクション対策をしてデータベースに保存する。 9 請求先：郵便番号 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 10 請求先：都道府県 データベース/画面 画面の対象フォーム内に保存された値が指し示す選択肢のラベルを全て出力する。入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 11 請求先：市区町村 データベース/画面 画面の対象フォーム内に保存された値が指し示す選択肢のラベルを全て出力する。入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 12 請求先：以降の住所 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 13 請求先：会社名 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 14 請求先：担当部署 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 15 請求先：担当者名 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 16 振込先：金融機関番号 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 17 振込先：金融機関名 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 18 振込先：支店番号 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 19 振込先：支店名 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 20 振込先：口座種別 データベース/画面 画面の対象フォーム内に保存された値が指し示す選択肢のラベルを全て出力する。入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 21 振込先：口座番号 データベース/画面 画面の対象フォーム内にHTMLエスケープ処理をして出力、入力エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合、または管理者権限でログインしていない場合は全体管理者画面のログイン画面にリダイレクトする。 URL文字列または隠しフォーム入力から請求先・振込先マスタ番号文字列を取得し、入力がない場合/自然数ではない場合はレスポンスステータス404 not foundを出力して処理を終了する。 指定された請求先・振込先マスタ番号でデータベースから該当するレコードを抽出する。 該当するレコードがデータベース上に存在しない場合はレスポンスステータス404 not foundを出力して処理を終了する。 4.4.1. 編集フォーム画面表示処理 該当するレコードが見つかったら、出力に記載の通り、表示項目と入力可能項目に項目値を反映させて画面を出力し処理を終了する。 4.4.2. 編集処理 該当するレコードが見つかったら、出力に記載の入力項目値の妥当性検査を行う。 入力項目値の妥当性に問題があった場合は、どの項目にどのような問題が発生したかわかるようにエラーメッセージを表示し、入力された値を入力フォーム内に表示・選択された状態で編集フォーム画面を出力して処理を終了する。 入力項目値の妥当性に問題がない場合は、入力された項目値と、更新日時を操作している現在時刻とし、操作を行なっている管理者番号を更新者に設定した上でデータベースの該当レコードを更新する。 該当のレコードの保存した情報を閲覧できる 472_【FIX】請求先マスタ一覧閲覧機能 へリダイレクトし処理を終了する。 4.5. エラー処理 上記以外で発生したエラー/例外に関してはフレームワークの例外処理に任せる。 4.6. ログ 編集画面に遷移した場合に下記フォーマットでログを出力する User {全体管理者のユーザー番号} started to update company billing account. company_billing_account_number={請求先・振込先マスタ番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 編集処理を実行した場合に下記フォーマットでログを出力する 成功の場合 User {全体管理者のユーザー番号} updated company billing account. company_billing_account_number={請求先・振込先マスタ番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 失敗の場合 User {全体管理者のユーザー番号} failed to update company billing account. company_billing_account_number={請求先・振込先マスタ番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. 制限事項 最後に閲覧していた 472_【FIX】請求先マスタ一覧閲覧機能 のページに戻るための機能はアプリケーションでは提供しない。 同時編集に対する明示的な対策は施さない。 同時に編集が実行された際は後勝ちとし、後から保存ボタンを押して実行した時の編集値が適用される。 編集画面において他のユーザーまたは他のウィンドウ・タブが本機能にアクセスしたことをアプリケーションは検知しない。",
  "parentId": "910459114",
  "parentTitle": "470_請求先マスタ管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/910884866/473_+FIX",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2024-03-12T09:22:40.812Z",
  "author": "isamu saito",
  "excerpt": "1. 目次 1 6 false list false 2. 概要 本機能は 【作成中】企業：請求先・振込先マスタ の登録済みのデータ1件を編集するための機能です。 3. 要求事項 全体管理画面にログインすることができるシステム管理者、塾講師ステーション管理者のみが本機能を利用することができる。 登録されている 【作成中】企業：請求先・振込先マスタ 1件の登録済み情報を閲覧し、本ページの 「要件定義..."
}