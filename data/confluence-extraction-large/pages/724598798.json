{
  "id": "724598798",
  "title": "176_【FIX】求人掲載フラグ切り替え機能（API）",
  "content": "1. 目次 2. 概 要 本機能は 【FIX】応募情報 の登録済みのデータの掲載フラグを編集するためのAPIです。 3. 要求 事項 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/709296160 から呼び出すAPIとして実装する。 管理画面にログインできるシステム管理者、塾講師ステーション管理者、ゲスト管理者のみが、概要で挙げた帳票に登録されたデータの掲載フラグを編集することができる。 エラーがなければJSONボディとして入力された「掲載フラグ」の値を、新しい「掲載フラグ」としてレコードを更新する。 保存が完了したら エリア平均給与算出共通処理 を実行する。 3.1. 権限 管理画面にログインできるシステム管理者、塾講師ステーション管理者、ゲスト管理者のみ 3.2. 帳票 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704053484 の記載と同じ 3.3. メールテンプレート なし 3.4. ワークフロー https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/704053484 の記載と同じ 3.4.1. 本機能 3.4.2. 関連 4. 要件定義 4.1. ユーザーインターフェース （画面） なし 4.2. 入力 説明は、帳票の各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 項目名 変数名 入力元 説明 制限とエラーメッセージ 1 求人番号 JSONボディ 操作する対象の求人の 【FIX】求人：基本情報 における求人番号 2 掲載フラグ JSONボディ 変更後の値を送信する 4.3. 出力 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/811499640/API#1.1.-CRUD%E5%85%B1%E9%80%9A%E5%87%BA%E5%8A%9B を常に含める。また説明は、帳票の各ページの記載を前提とし、本ページに固有の特記事項のみ記載する。 出力項目 出力先 説明 1 求人番号 JSONボディ 2 掲載フラグ JSONボディ／データベース エラーがない場合はSQLインジェクション対策をしてデータベースに保存する。 3 掲載日時 データベース 掲載とした時間を登録する。 4 非掲載日時 データベース 非掲載とした時間を登録する。 5 更新者 データベース 【作成中】帳票共通項目 に従う。 6 更新日時 データベース 【作成中】帳票共通項目 に従う。 4.4. 処理 ログイン状態を確認し、ログイン認証されていない場合はログイン認証エラーとし、ログイン認証されているが権限の章に記載した権限を持っていない場合は権限エラーとする。 入力欄（ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/724598798#4.2.-%E5%85%A5%E5%8A%9B ）に記載の項目の入力処理をおこなう。 出力欄（ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/724598798#4.3.-%E5%87%BA%E5%8A%9B ）に記載した出力項目を出力する。 4.4.1. フラグ切り替え処理 該当する求人レコードが見つかったら、「入力」（ https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/724598798#4.2.-%E5%85%A5%E5%8A%9B ）に記載の入力項目値の妥当性検査を行う。 入力項目値の妥当性に問題があった場合は、どの項目にどのような問題が発生したかわかるようにエラーを返し処理を終了する。 入力項目値の妥当性に問題がない場合は、入力された項目値と、更新日時を操作している現在時刻とし、操作を行なっている全体管理者のユーザー番号を更新者に設定した上でデータベースの該当レコードを更新する。 編集が完了したことが分かる ポップアップを https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/709296160 の画面上で 表示 して処理を終了する。 4.5. エラー処理 上記以外で発生したエラー/例外に関してはフレームワークの例外処理に任せる。 4.6. ログ 編集処理を実行した場合に下記フォーマットでログを出力する 成功の場合 User {全体管理者のユーザー番号} updated job published flag. job_number={求人番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 失敗の場合 User {全体管理者のユーザー番号} failed to update job published flag. job_number={求人番号} {アクセスURI} {日時} {アクセス元IPアドレス} {ユーザーエージェント} 5. スコープ外・制限事項 なし",
  "parentId": "704053484",
  "parentTitle": "170_【要求FIX】求人管理機能",
  "labels": [],
  "url": "/spaces/CLIENTTOMO/pages/724598798/176_+FIX+API",
  "spaceKey": "CLIENTTOMO",
  "lastModified": "2025-03-04T08:01:00.872Z",
  "author": "ejiri_yusuke",
  "excerpt": "1. 目次 2. 概 要 本機能は 【FIX】応募情報 の登録済みのデータの掲載フラグを編集するためのAPIです。 3. 要求 事項 https://giginc.atlassian.net/wiki/spaces/CLIENTTOMO/pages/709296160 から呼び出すAPIとして実装する。 管理画面にログインできるシステム管理者、塾講師ステーション管理者、ゲスト管理者のみが、概要で挙..."
}